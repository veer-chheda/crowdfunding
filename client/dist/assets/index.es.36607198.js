import{dv as Ov,d7 as Gr,dw as Nv,dx as lr,dy as xv,dz as Dv,dA as Tv,dB as ie,dC as $v,dD as Mr,dE as _e,dF as V,dG as Ft,dH as Fi,dI as jv,dJ as at,dK as Mv,dL as zt,dM as Bt,dN as Lv,dO as Hv,dP as gs,dQ as Tc,dR as hr,dS as Hi,dT as pc,dU as vs,dV as it,dW as Lr,dX as Uv,dY as kv,dZ as ms,d_ as fc,d$ as Hr,e0 as Vv,e1 as Fv,e2 as zv,e3 as dc,e4 as Bv,e5 as Gv,e6 as Wv,e7 as Kv,e8 as Qv,e9 as Jv,ea as Yv,eb as Zv,ec as Xv,ed as em,ee as tm,ef as rm,eg as im,eh as qs,ei as nm,ej as sm,X as om,dq as am,ek as gc,el as vc,em as cm,en as um,cZ as mc,eo as Br,ep as Fr,eq as $c,er as ys,es as xt,et as hm,eu as lm}from"./index.293c77a4.js";const jc="wc",Mc=2,Lc="client",Os=`${jc}@${Mc}:${Lc}:`,_s={name:Lc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},yc="WALLETCONNECT_DEEPLINK_CHOICE",pm="proposal",Hc="Proposal expired",fm="session",Ui=ie.SEVEN_DAYS,dm="engine",Ur={wc_sessionPropose:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1115}}},ws={min:ie.FIVE_MINUTES,max:ie.SEVEN_DAYS},_t={idle:"IDLE",active:"ACTIVE"},gm="request",vm=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var mm=Object.defineProperty,ym=Object.defineProperties,_m=Object.getOwnPropertyDescriptors,_c=Object.getOwnPropertySymbols,wm=Object.prototype.hasOwnProperty,Im=Object.prototype.propertyIsEnumerable,wc=(P,n,i)=>n in P?mm(P,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):P[n]=i,De=(P,n)=>{for(var i in n||(n={}))wm.call(n,i)&&wc(P,i,n[i]);if(_c)for(var i of _c(n))Im.call(n,i)&&wc(P,i,n[i]);return P},kr=(P,n)=>ym(P,_m(n));class Em extends Dv{constructor(n){super(n),this.name=dm,this.events=new Gr.exports,this.initialized=!1,this.ignoredPayloadTypes=[Tv],this.requestQueue={state:_t.idle,queue:[]},this.sessionRequestQueue={state:_t.idle,queue:[]},this.requestQueueDelay=ie.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Ur)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay)))},this.connect=async i=>{await this.isInitialized();const o=kr(De({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(o);const{pairingTopic:c,requiredNamespaces:f,optionalNamespaces:y,sessionProperties:E,relays:S}=o;let q=c,j,M=!1;if(q&&(M=this.client.core.pairing.pairings.get(q).active),!q||!M){const{topic:fe,uri:ue}=await this.client.core.pairing.create();q=fe,j=ue}const H=await this.client.core.crypto.generateKeyPair(),J=De({requiredNamespaces:f,optionalNamespaces:y,relays:S!=null?S:[{protocol:$v}],proposer:{publicKey:H,metadata:this.client.metadata}},E&&{sessionProperties:E}),{reject:F,resolve:Ce,done:pe}=Mr(ie.FIVE_MINUTES,Hc);if(this.events.once(_e("session_connect"),async({error:fe,session:ue})=>{if(fe)F(fe);else if(ue){ue.self.publicKey=H;const we=kr(De({},ue),{requiredNamespaces:ue.requiredNamespaces,optionalNamespaces:ue.optionalNamespaces});await this.client.session.set(ue.topic,we),await this.setExpiry(ue.topic,ue.expiry),q&&await this.client.core.pairing.updateMetadata({topic:q,metadata:ue.peer.metadata}),Ce(we)}}),!q){const{message:fe}=V("NO_MATCHING_KEY",`connect() pairing topic: ${q}`);throw new Error(fe)}const Ae=await this.sendRequest({topic:q,method:"wc_sessionPropose",params:J}),Wt=Ft(ie.FIVE_MINUTES);return await this.setProposal(Ae,De({id:Ae,expiry:Wt},J)),{uri:j,approval:pe}},this.pair=async i=>(await this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{await this.isInitialized(),await this.isValidApprove(i);const{id:o,relayProtocol:c,namespaces:f,sessionProperties:y}=i,E=this.client.proposal.get(o);let{pairingTopic:S,proposer:q,requiredNamespaces:j,optionalNamespaces:M}=E;S=S||"",Fi(j)||(j=jv(f,"approve()"));const H=await this.client.core.crypto.generateKeyPair(),J=q.publicKey,F=await this.client.core.crypto.generateSharedKey(H,J);S&&o&&(await this.client.core.pairing.updateMetadata({topic:S,metadata:q.metadata}),await this.sendResult({id:o,topic:S,result:{relay:{protocol:c!=null?c:"irn"},responderPublicKey:H}}),await this.client.proposal.delete(o,at("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:S}));const Ce=De({relay:{protocol:c!=null?c:"irn"},namespaces:f,requiredNamespaces:j,optionalNamespaces:M,pairingTopic:S,controller:{publicKey:H,metadata:this.client.metadata},expiry:Ft(Ui)},y&&{sessionProperties:y});await this.client.core.relayer.subscribe(F),await this.sendRequest({topic:F,method:"wc_sessionSettle",params:Ce,throwOnFailedPublish:!0});const pe=kr(De({},Ce),{topic:F,pairingTopic:S,acknowledged:!1,self:Ce.controller,peer:{publicKey:q.publicKey,metadata:q.metadata},controller:H});return await this.client.session.set(F,pe),await this.setExpiry(F,Ft(Ui)),{topic:F,acknowledged:()=>new Promise(Ae=>setTimeout(()=>Ae(this.client.session.get(F)),500))}},this.reject=async i=>{await this.isInitialized(),await this.isValidReject(i);const{id:o,reason:c}=i,{pairingTopic:f}=this.client.proposal.get(o);f&&(await this.sendError(o,f,c),await this.client.proposal.delete(o,at("USER_DISCONNECTED")))},this.update=async i=>{await this.isInitialized(),await this.isValidUpdate(i);const{topic:o,namespaces:c}=i,f=await this.sendRequest({topic:o,method:"wc_sessionUpdate",params:{namespaces:c}}),{done:y,resolve:E,reject:S}=Mr();return this.events.once(_e("session_update",f),({error:q})=>{q?S(q):E()}),await this.client.session.update(o,{namespaces:c}),{acknowledged:y}},this.extend=async i=>{await this.isInitialized(),await this.isValidExtend(i);const{topic:o}=i,c=await this.sendRequest({topic:o,method:"wc_sessionExtend",params:{}}),{done:f,resolve:y,reject:E}=Mr();return this.events.once(_e("session_extend",c),({error:S})=>{S?E(S):y()}),await this.setExpiry(o,Ft(Ui)),{acknowledged:f}},this.request=async i=>{await this.isInitialized(),await this.isValidRequest(i);const{chainId:o,request:c,topic:f,expiry:y}=i,E=nm(),{done:S,resolve:q,reject:j}=Mr(y,"Request expired. Please try again.");return this.events.once(_e("session_request",E),({error:M,result:H})=>{M?j(M):q(H)}),await Promise.all([new Promise(async M=>{await this.sendRequest({clientRpcId:E,topic:f,method:"wc_sessionRequest",params:{request:c,chainId:o},expiry:y,throwOnFailedPublish:!0}).catch(H=>j(H)),this.client.events.emit("session_request_sent",{topic:f,request:c,chainId:o,id:E}),M()}),new Promise(async M=>{const H=await this.client.core.storage.getItem(yc);Mv({id:E,topic:f,wcDeepLink:H}),M()}),S()]).then(M=>M[2])},this.respond=async i=>{await this.isInitialized(),await this.isValidRespond(i);const{topic:o,response:c}=i,{id:f}=c;zt(c)?await this.sendResult({id:f,topic:o,result:c.result,throwOnFailedPublish:!0}):Bt(c)&&await this.sendError(f,o,c.error),this.cleanupAfterResponse(i)},this.ping=async i=>{await this.isInitialized(),await this.isValidPing(i);const{topic:o}=i;if(this.client.session.keys.includes(o)){const c=await this.sendRequest({topic:o,method:"wc_sessionPing",params:{}}),{done:f,resolve:y,reject:E}=Mr();this.events.once(_e("session_ping",c),({error:S})=>{S?E(S):y()}),await f()}else this.client.core.pairing.pairings.keys.includes(o)&&await this.client.core.pairing.ping({topic:o})},this.emit=async i=>{await this.isInitialized(),await this.isValidEmit(i);const{topic:o,event:c,chainId:f}=i;await this.sendRequest({topic:o,method:"wc_sessionEvent",params:{event:c,chainId:f}})},this.disconnect=async i=>{await this.isInitialized(),await this.isValidDisconnect(i);const{topic:o}=i;this.client.session.keys.includes(o)?(await this.sendRequest({topic:o,method:"wc_sessionDelete",params:at("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(o)):await this.client.core.pairing.disconnect({topic:o})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(o=>Lv(o,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const o=this.client.core.pairing.pairings.get(i.pairingTopic),c=this.client.core.pairing.pairings.getAll().filter(f=>{var y,E;return((y=f.peerMetadata)==null?void 0:y.url)&&((E=f.peerMetadata)==null?void 0:E.url)===i.peer.metadata.url&&f.topic&&f.topic!==o.topic});if(c.length===0)return;this.client.logger.info(`Cleaning up ${c.length} duplicate pairing(s)`),await Promise.all(c.map(f=>this.client.core.pairing.disconnect({topic:f.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(o){this.client.logger.error(o)}},this.deleteSession=async(i,o)=>{const{self:c}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,at("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),o||this.client.core.expirer.del(i),this.client.core.storage.removeItem(yc).catch(f=>this.client.logger.warn(f))},this.deleteProposal=async(i,o)=>{await Promise.all([this.client.proposal.delete(i,at("USER_DISCONNECTED")),o?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,o,c=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,o),c?Promise.resolve():this.client.core.expirer.del(i)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(f=>f.id!==i),c&&(this.sessionRequestQueue.state=_t.idle)},this.setExpiry=async(i,o)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:o}),this.client.core.expirer.set(i,o)},this.setProposal=async(i,o)=>{await this.client.proposal.set(i,o),this.client.core.expirer.set(i,o.expiry)},this.setPendingSessionRequest=async i=>{const o=Ur.wc_sessionRequest.req.ttl,{id:c,topic:f,params:y,verifyContext:E}=i;await this.client.pendingRequest.set(c,{id:c,topic:f,params:y,verifyContext:E}),o&&this.client.core.expirer.set(c,Ft(o))},this.sendRequest=async i=>{const{topic:o,method:c,params:f,expiry:y,relayRpcId:E,clientRpcId:S,throwOnFailedPublish:q}=i,j=vs(c,f,S);if(Hv()&&vm.includes(c)){const J=gs(JSON.stringify(j));this.client.core.verify.register({attestationId:J})}const M=await this.client.core.crypto.encode(o,j),H=Ur[c].req;return y&&(H.ttl=y),E&&(H.id=E),this.client.core.history.set(o,j),q?(H.internal=kr(De({},H.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,M,H)):this.client.core.relayer.publish(o,M,H).catch(J=>this.client.logger.error(J)),j.id},this.sendResult=async i=>{const{id:o,topic:c,result:f,throwOnFailedPublish:y}=i,E=sm(o,f),S=await this.client.core.crypto.encode(c,E),q=await this.client.core.history.get(c,o),j=Ur[q.request.method].res;y?(j.internal=kr(De({},j.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(c,S,j)):this.client.core.relayer.publish(c,S,j).catch(M=>this.client.logger.error(M)),await this.client.core.history.resolve(E)},this.sendError=async(i,o,c)=>{const f=Tc(i,c),y=await this.client.core.crypto.encode(o,f),E=await this.client.core.history.get(o,i),S=Ur[E.request.method].res;this.client.core.relayer.publish(o,y,S),await this.client.core.history.resolve(f)},this.cleanup=async()=>{const i=[],o=[];this.client.session.getAll().forEach(c=>{hr(c.expiry)&&i.push(c.topic)}),this.client.proposal.getAll().forEach(c=>{hr(c.expiry)&&o.push(c.id)}),await Promise.all([...i.map(c=>this.deleteSession(c)),...o.map(c=>this.deleteProposal(c))])},this.onRelayEventRequest=async i=>{this.requestQueue.queue.push(i),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===_t.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=_t.active;const i=this.requestQueue.queue.shift();if(i)try{this.processRequest(i),await new Promise(o=>setTimeout(o,300))}catch(o){this.client.logger.warn(o)}}this.requestQueue.state=_t.idle},this.processRequest=i=>{const{topic:o,payload:c}=i,f=c.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeRequest(o,c);case"wc_sessionSettle":return this.onSessionSettleRequest(o,c);case"wc_sessionUpdate":return this.onSessionUpdateRequest(o,c);case"wc_sessionExtend":return this.onSessionExtendRequest(o,c);case"wc_sessionPing":return this.onSessionPingRequest(o,c);case"wc_sessionDelete":return this.onSessionDeleteRequest(o,c);case"wc_sessionRequest":return this.onSessionRequest(o,c);case"wc_sessionEvent":return this.onSessionEventRequest(o,c);default:return this.client.logger.info(`Unsupported request method ${f}`)}},this.onRelayEventResponse=async i=>{const{topic:o,payload:c}=i,f=(await this.client.core.history.get(o,c.id)).request.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeResponse(o,c);case"wc_sessionSettle":return this.onSessionSettleResponse(o,c);case"wc_sessionUpdate":return this.onSessionUpdateResponse(o,c);case"wc_sessionExtend":return this.onSessionExtendResponse(o,c);case"wc_sessionPing":return this.onSessionPingResponse(o,c);case"wc_sessionRequest":return this.onSessionRequestResponse(o,c);default:return this.client.logger.info(`Unsupported response method ${f}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:o}=i,{message:c}=V("MISSING_OR_INVALID",`Decoded payload on topic ${o} is not identifiable as a JSON-RPC request or a response.`);throw new Error(c)},this.onSessionProposeRequest=async(i,o)=>{const{params:c,id:f}=o;try{this.isValidConnect(De({},o.params));const y=Ft(ie.FIVE_MINUTES),E=De({id:f,pairingTopic:i,expiry:y},c);await this.setProposal(f,E);const S=gs(JSON.stringify(o)),q=await this.getVerifyContext(S,E.proposer.metadata);this.client.events.emit("session_proposal",{id:f,params:E,verifyContext:q})}catch(y){await this.sendError(f,i,y),this.client.logger.error(y)}},this.onSessionProposeResponse=async(i,o)=>{const{id:c}=o;if(zt(o)){const{result:f}=o;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:f});const y=this.client.proposal.get(c);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:y});const E=y.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:E});const S=f.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:S});const q=await this.client.core.crypto.generateSharedKey(E,S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:q});const j=await this.client.core.relayer.subscribe(q);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:j}),await this.client.core.pairing.activate({topic:i})}else Bt(o)&&(await this.client.proposal.delete(c,at("USER_DISCONNECTED")),this.events.emit(_e("session_connect"),{error:o.error}))},this.onSessionSettleRequest=async(i,o)=>{const{id:c,params:f}=o;try{this.isValidSessionSettleRequest(f);const{relay:y,controller:E,expiry:S,namespaces:q,requiredNamespaces:j,optionalNamespaces:M,sessionProperties:H,pairingTopic:J}=o.params,F=De({topic:i,relay:y,expiry:S,namespaces:q,acknowledged:!0,pairingTopic:J,requiredNamespaces:j,optionalNamespaces:M,controller:E.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:E.publicKey,metadata:E.metadata}},H&&{sessionProperties:H});await this.sendResult({id:o.id,topic:i,result:!0}),this.events.emit(_e("session_connect"),{session:F}),this.cleanupDuplicatePairings(F)}catch(y){await this.sendError(c,i,y),this.client.logger.error(y)}},this.onSessionSettleResponse=async(i,o)=>{const{id:c}=o;zt(o)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(_e("session_approve",c),{})):Bt(o)&&(await this.client.session.delete(i,at("USER_DISCONNECTED")),this.events.emit(_e("session_approve",c),{error:o.error}))},this.onSessionUpdateRequest=async(i,o)=>{const{params:c,id:f}=o;try{const y=`${i}_session_update`,E=Hi.get(y);if(E&&this.isRequestOutOfSync(E,f)){this.client.logger.info(`Discarding out of sync request - ${f}`);return}this.isValidUpdate(De({topic:i},c)),await this.client.session.update(i,{namespaces:c.namespaces}),await this.sendResult({id:f,topic:i,result:!0}),this.client.events.emit("session_update",{id:f,topic:i,params:c}),Hi.set(y,f)}catch(y){await this.sendError(f,i,y),this.client.logger.error(y)}},this.isRequestOutOfSync=(i,o)=>parseInt(o.toString().slice(0,-3))<=parseInt(i.toString().slice(0,-3)),this.onSessionUpdateResponse=(i,o)=>{const{id:c}=o;zt(o)?this.events.emit(_e("session_update",c),{}):Bt(o)&&this.events.emit(_e("session_update",c),{error:o.error})},this.onSessionExtendRequest=async(i,o)=>{const{id:c}=o;try{this.isValidExtend({topic:i}),await this.setExpiry(i,Ft(Ui)),await this.sendResult({id:c,topic:i,result:!0}),this.client.events.emit("session_extend",{id:c,topic:i})}catch(f){await this.sendError(c,i,f),this.client.logger.error(f)}},this.onSessionExtendResponse=(i,o)=>{const{id:c}=o;zt(o)?this.events.emit(_e("session_extend",c),{}):Bt(o)&&this.events.emit(_e("session_extend",c),{error:o.error})},this.onSessionPingRequest=async(i,o)=>{const{id:c}=o;try{this.isValidPing({topic:i}),await this.sendResult({id:c,topic:i,result:!0}),this.client.events.emit("session_ping",{id:c,topic:i})}catch(f){await this.sendError(c,i,f),this.client.logger.error(f)}},this.onSessionPingResponse=(i,o)=>{const{id:c}=o;setTimeout(()=>{zt(o)?this.events.emit(_e("session_ping",c),{}):Bt(o)&&this.events.emit(_e("session_ping",c),{error:o.error})},500)},this.onSessionDeleteRequest=async(i,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:i,reason:o.params}),await Promise.all([new Promise(f=>{this.client.core.relayer.once(pc.publish,async()=>{f(await this.deleteSession(i))})}),this.sendResult({id:c,topic:i,result:!0})]),this.client.events.emit("session_delete",{id:c,topic:i})}catch(f){this.client.logger.error(f)}},this.onSessionRequest=async(i,o)=>{const{id:c,params:f}=o;try{this.isValidRequest(De({topic:i},f));const y=gs(JSON.stringify(vs("wc_sessionRequest",f,c))),E=this.client.session.get(i),S=await this.getVerifyContext(y,E.peer.metadata),q={id:c,topic:i,params:f,verifyContext:S};await this.setPendingSessionRequest(q),this.addSessionRequestToSessionRequestQueue(q),this.processSessionRequestQueue()}catch(y){await this.sendError(c,i,y),this.client.logger.error(y)}},this.onSessionRequestResponse=(i,o)=>{const{id:c}=o;zt(o)?this.events.emit(_e("session_request",c),{result:o.result}):Bt(o)&&this.events.emit(_e("session_request",c),{error:o.error})},this.onSessionEventRequest=async(i,o)=>{const{id:c,params:f}=o;try{const y=`${i}_session_event_${f.event.name}`,E=Hi.get(y);if(E&&this.isRequestOutOfSync(E,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidEmit(De({topic:i},f)),this.client.events.emit("session_event",{id:c,topic:i,params:f}),Hi.set(y,c)}catch(y){await this.sendError(c,i,y),this.client.logger.error(y)}},this.addSessionRequestToSessionRequestQueue=i=>{this.sessionRequestQueue.queue.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=_t.idle,this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===_t.active){this.client.logger.info("session request queue is already active.");return}const i=this.sessionRequestQueue.queue[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=_t.active,this.client.events.emit("session_request",i)}catch(o){this.client.logger.error(o)}},this.onPairingCreated=i=>{if(i.active)return;const o=this.client.proposal.getAll().find(c=>c.pairingTopic===i.topic);o&&this.onSessionProposeRequest(i.topic,vs("wc_sessionPropose",{requiredNamespaces:o.requiredNamespaces,optionalNamespaces:o.optionalNamespaces,relays:o.relays,proposer:o.proposer},o.id))},this.isValidConnect=async i=>{if(!it(i)){const{message:S}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(S)}const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:f,sessionProperties:y,relays:E}=i;if(Lr(o)||await this.isValidPairingTopic(o),!Uv(E,!0)){const{message:S}=V("MISSING_OR_INVALID",`connect() relays: ${E}`);throw new Error(S)}!Lr(c)&&Fi(c)!==0&&this.validateNamespaces(c,"requiredNamespaces"),!Lr(f)&&Fi(f)!==0&&this.validateNamespaces(f,"optionalNamespaces"),Lr(y)||this.validateSessionProps(y,"sessionProperties")},this.validateNamespaces=(i,o)=>{const c=kv(i,"connect()",o);if(c)throw new Error(c.message)},this.isValidApprove=async i=>{if(!it(i))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:o,namespaces:c,relayProtocol:f,sessionProperties:y}=i;await this.isValidProposalId(o);const E=this.client.proposal.get(o),S=ms(c,"approve()");if(S)throw new Error(S.message);const q=fc(E.requiredNamespaces,c,"approve()");if(q)throw new Error(q.message);if(!Hr(f,!0)){const{message:j}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${f}`);throw new Error(j)}Lr(y)||this.validateSessionProps(y,"sessionProperties")},this.isValidReject=async i=>{if(!it(i)){const{message:f}=V("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(f)}const{id:o,reason:c}=i;if(await this.isValidProposalId(o),!Vv(c)){const{message:f}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(c)}`);throw new Error(f)}},this.isValidSessionSettleRequest=i=>{if(!it(i)){const{message:q}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(q)}const{relay:o,controller:c,namespaces:f,expiry:y}=i;if(!Fv(o)){const{message:q}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(q)}const E=zv(c,"onSessionSettleRequest()");if(E)throw new Error(E.message);const S=ms(f,"onSessionSettleRequest()");if(S)throw new Error(S.message);if(hr(y)){const{message:q}=V("EXPIRED","onSessionSettleRequest()");throw new Error(q)}},this.isValidUpdate=async i=>{if(!it(i)){const{message:S}=V("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(S)}const{topic:o,namespaces:c}=i;await this.isValidSessionTopic(o);const f=this.client.session.get(o),y=ms(c,"update()");if(y)throw new Error(y.message);const E=fc(f.requiredNamespaces,c,"update()");if(E)throw new Error(E.message)},this.isValidExtend=async i=>{if(!it(i)){const{message:c}=V("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(c)}const{topic:o}=i;await this.isValidSessionTopic(o)},this.isValidRequest=async i=>{if(!it(i)){const{message:S}=V("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(S)}const{topic:o,request:c,chainId:f,expiry:y}=i;await this.isValidSessionTopic(o);const{namespaces:E}=this.client.session.get(o);if(!dc(E,f)){const{message:S}=V("MISSING_OR_INVALID",`request() chainId: ${f}`);throw new Error(S)}if(!Bv(c)){const{message:S}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(c)}`);throw new Error(S)}if(!Gv(E,f,c.method)){const{message:S}=V("MISSING_OR_INVALID",`request() method: ${c.method}`);throw new Error(S)}if(y&&!Wv(y,ws)){const{message:S}=V("MISSING_OR_INVALID",`request() expiry: ${y}. Expiry must be a number (in seconds) between ${ws.min} and ${ws.max}`);throw new Error(S)}},this.isValidRespond=async i=>{if(!it(i)){const{message:f}=V("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(f)}const{topic:o,response:c}=i;if(await this.isValidSessionTopic(o),!Kv(c)){const{message:f}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(f)}},this.isValidPing=async i=>{if(!it(i)){const{message:c}=V("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(c)}const{topic:o}=i;await this.isValidSessionOrPairingTopic(o)},this.isValidEmit=async i=>{if(!it(i)){const{message:E}=V("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(E)}const{topic:o,event:c,chainId:f}=i;await this.isValidSessionTopic(o);const{namespaces:y}=this.client.session.get(o);if(!dc(y,f)){const{message:E}=V("MISSING_OR_INVALID",`emit() chainId: ${f}`);throw new Error(E)}if(!Qv(c)){const{message:E}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(c)}`);throw new Error(E)}if(!Jv(y,f,c.name)){const{message:E}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(c)}`);throw new Error(E)}},this.isValidDisconnect=async i=>{if(!it(i)){const{message:c}=V("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(c)}const{topic:o}=i;await this.isValidSessionOrPairingTopic(o)},this.getVerifyContext=async(i,o)=>{const c={verified:{verifyUrl:o.verifyUrl||Yv,validation:"UNKNOWN",origin:o.url||""}};try{const f=await this.client.core.verify.resolve({attestationId:i,verifyUrl:o.verifyUrl});f&&(c.verified.origin=f.origin,c.verified.isScam=f.isScam,c.verified.validation=f.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(f){this.client.logger.info(f)}return this.client.logger.info(`Verify context: ${JSON.stringify(c)}`),c},this.validateSessionProps=(i,o)=>{Object.values(i).forEach(c=>{if(!Hr(c,!1)){const{message:f}=V("MISSING_OR_INVALID",`${o} must be in Record<string, string> format. Received: ${JSON.stringify(c)}`);throw new Error(f)}})}}async isInitialized(){if(!this.initialized){const{message:n}=V("NOT_INITIALIZED",this.name);throw new Error(n)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(pc.message,async n=>{const{topic:i,message:o}=n;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(o)))return;const c=await this.client.core.crypto.decode(i,o);try{Zv(c)?(this.client.core.history.set(i,c),this.onRelayEventRequest({topic:i,payload:c})):Xv(c)?(await this.client.core.history.resolve(c),await this.onRelayEventResponse({topic:i,payload:c}),this.client.core.history.delete(i,c.id)):this.onRelayEventUnknownPayload({topic:i,payload:c})}catch(f){this.client.logger.error(f)}})}registerExpirerEvents(){this.client.core.expirer.on(em.expired,async n=>{const{topic:i,id:o}=tm(n.target);if(o&&this.client.pendingRequest.keys.includes(o))return await this.deletePendingSessionRequest(o,V("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):o&&(await this.deleteProposal(o,!0),this.client.events.emit("proposal_expire",{id:o}))})}registerPairingEvents(){this.client.core.pairing.events.on(rm.create,n=>this.onPairingCreated(n))}isValidPairingTopic(n){if(!Hr(n,!1)){const{message:i}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(n)){const{message:i}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(hr(this.client.core.pairing.pairings.get(n).expiry)){const{message:i}=V("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}}async isValidSessionTopic(n){if(!Hr(n,!1)){const{message:i}=V("MISSING_OR_INVALID",`session topic should be a string: ${n}`);throw new Error(i)}if(!this.client.session.keys.includes(n)){const{message:i}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${n}`);throw new Error(i)}if(hr(this.client.session.get(n).expiry)){await this.deleteSession(n);const{message:i}=V("EXPIRED",`session topic: ${n}`);throw new Error(i)}}async isValidSessionOrPairingTopic(n){if(this.client.session.keys.includes(n))await this.isValidSessionTopic(n);else if(this.client.core.pairing.pairings.keys.includes(n))this.isValidPairingTopic(n);else if(Hr(n,!1)){const{message:i}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${n}`);throw new Error(i)}else{const{message:i}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${n}`);throw new Error(i)}}async isValidProposalId(n){if(!im(n)){const{message:i}=V("MISSING_OR_INVALID",`proposal id should be a number: ${n}`);throw new Error(i)}if(!this.client.proposal.keys.includes(n)){const{message:i}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${n}`);throw new Error(i)}if(hr(this.client.proposal.get(n).expiry)){await this.deleteProposal(n);const{message:i}=V("EXPIRED",`proposal id: ${n}`);throw new Error(i)}}}class bm extends qs{constructor(n,i){super(n,i,pm,Os),this.core=n,this.logger=i}}class Pm extends qs{constructor(n,i){super(n,i,fm,Os),this.core=n,this.logger=i}}class Sm extends qs{constructor(n,i){super(n,i,gm,Os,o=>o.id),this.core=n,this.logger=i}}class Ns extends Ov{constructor(n){super(n),this.protocol=jc,this.version=Mc,this.name=_s.name,this.events=new Gr.exports.EventEmitter,this.on=(o,c)=>this.events.on(o,c),this.once=(o,c)=>this.events.once(o,c),this.off=(o,c)=>this.events.off(o,c),this.removeListener=(o,c)=>this.events.removeListener(o,c),this.removeAllListeners=o=>this.events.removeAllListeners(o),this.connect=async o=>{try{return await this.engine.connect(o)}catch(c){throw this.logger.error(c.message),c}},this.pair=async o=>{try{return await this.engine.pair(o)}catch(c){throw this.logger.error(c.message),c}},this.approve=async o=>{try{return await this.engine.approve(o)}catch(c){throw this.logger.error(c.message),c}},this.reject=async o=>{try{return await this.engine.reject(o)}catch(c){throw this.logger.error(c.message),c}},this.update=async o=>{try{return await this.engine.update(o)}catch(c){throw this.logger.error(c.message),c}},this.extend=async o=>{try{return await this.engine.extend(o)}catch(c){throw this.logger.error(c.message),c}},this.request=async o=>{try{return await this.engine.request(o)}catch(c){throw this.logger.error(c.message),c}},this.respond=async o=>{try{return await this.engine.respond(o)}catch(c){throw this.logger.error(c.message),c}},this.ping=async o=>{try{return await this.engine.ping(o)}catch(c){throw this.logger.error(c.message),c}},this.emit=async o=>{try{return await this.engine.emit(o)}catch(c){throw this.logger.error(c.message),c}},this.disconnect=async o=>{try{return await this.engine.disconnect(o)}catch(c){throw this.logger.error(c.message),c}},this.find=o=>{try{return this.engine.find(o)}catch(c){throw this.logger.error(c.message),c}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(o){throw this.logger.error(o.message),o}},this.name=(n==null?void 0:n.name)||_s.name,this.metadata=(n==null?void 0:n.metadata)||Nv();const i=typeof(n==null?void 0:n.logger)<"u"&&typeof(n==null?void 0:n.logger)!="string"?n.logger:lr.pino(lr.getDefaultLoggerOptions({level:(n==null?void 0:n.logger)||_s.logger}));this.core=(n==null?void 0:n.core)||new xv(n),this.logger=lr.generateChildLogger(i,this.name),this.session=new Pm(this.core,this.logger),this.proposal=new bm(this.core,this.logger),this.pendingRequest=new Sm(this.core,this.logger),this.engine=new Em(this)}static async init(n){const i=new Ns(n);return await i.initialize(),i}get context(){return lr.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(n){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(n.message),n}}}var Ss={exports:{}};(function(P,n){var i=typeof self<"u"?self:om,o=function(){function f(){this.fetch=!1,this.DOMException=i.DOMException}return f.prototype=i,new f}();(function(f){(function(y){var E={searchParams:"URLSearchParams"in f,iterable:"Symbol"in f&&"iterator"in Symbol,blob:"FileReader"in f&&"Blob"in f&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in f,arrayBuffer:"ArrayBuffer"in f};function S(m){return m&&DataView.prototype.isPrototypeOf(m)}if(E.arrayBuffer)var q=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],j=ArrayBuffer.isView||function(m){return m&&q.indexOf(Object.prototype.toString.call(m))>-1};function M(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function H(m){return typeof m!="string"&&(m=String(m)),m}function J(m){var R={next:function(){var U=m.shift();return{done:U===void 0,value:U}}};return E.iterable&&(R[Symbol.iterator]=function(){return R}),R}function F(m){this.map={},m instanceof F?m.forEach(function(R,U){this.append(U,R)},this):Array.isArray(m)?m.forEach(function(R){this.append(R[0],R[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(R){this.append(R,m[R])},this)}F.prototype.append=function(m,R){m=M(m),R=H(R);var U=this.map[m];this.map[m]=U?U+", "+R:R},F.prototype.delete=function(m){delete this.map[M(m)]},F.prototype.get=function(m){return m=M(m),this.has(m)?this.map[m]:null},F.prototype.has=function(m){return this.map.hasOwnProperty(M(m))},F.prototype.set=function(m,R){this.map[M(m)]=H(R)},F.prototype.forEach=function(m,R){for(var U in this.map)this.map.hasOwnProperty(U)&&m.call(R,this.map[U],U,this)},F.prototype.keys=function(){var m=[];return this.forEach(function(R,U){m.push(U)}),J(m)},F.prototype.values=function(){var m=[];return this.forEach(function(R){m.push(R)}),J(m)},F.prototype.entries=function(){var m=[];return this.forEach(function(R,U){m.push([U,R])}),J(m)},E.iterable&&(F.prototype[Symbol.iterator]=F.prototype.entries);function Ce(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function pe(m){return new Promise(function(R,U){m.onload=function(){R(m.result)},m.onerror=function(){U(m.error)}})}function Ae(m){var R=new FileReader,U=pe(R);return R.readAsArrayBuffer(m),U}function Wt(m){var R=new FileReader,U=pe(R);return R.readAsText(m),U}function fe(m){for(var R=new Uint8Array(m),U=new Array(R.length),ne=0;ne<R.length;ne++)U[ne]=String.fromCharCode(R[ne]);return U.join("")}function ue(m){if(m.slice)return m.slice(0);var R=new Uint8Array(m.byteLength);return R.set(new Uint8Array(m)),R.buffer}function we(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:E.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:E.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:E.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():E.arrayBuffer&&E.blob&&S(m)?(this._bodyArrayBuffer=ue(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):E.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||j(m))?this._bodyArrayBuffer=ue(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):E.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},E.blob&&(this.blob=function(){var m=Ce(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Ce(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Ae)}),this.text=function(){var m=Ce(this);if(m)return m;if(this._bodyBlob)return Wt(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},E.formData&&(this.formData=function(){return this.text().then(pr)}),this.json=function(){return this.text().then(JSON.parse)},this}var It=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Je(m){var R=m.toUpperCase();return It.indexOf(R)>-1?R:m}function Te(m,R){R=R||{};var U=R.body;if(m instanceof Te){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,R.headers||(this.headers=new F(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!U&&m._bodyInit!=null&&(U=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=R.credentials||this.credentials||"same-origin",(R.headers||!this.headers)&&(this.headers=new F(R.headers)),this.method=Je(R.method||this.method||"GET"),this.mode=R.mode||this.mode||null,this.signal=R.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&U)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(U)}Te.prototype.clone=function(){return new Te(this,{body:this._bodyInit})};function pr(m){var R=new FormData;return m.trim().split("&").forEach(function(U){if(U){var ne=U.split("="),ee=ne.shift().replace(/\+/g," "),Y=ne.join("=").replace(/\+/g," ");R.append(decodeURIComponent(ee),decodeURIComponent(Y))}}),R}function Bi(m){var R=new F,U=m.replace(/\r?\n[\t ]+/g," ");return U.split(/\r?\n/).forEach(function(ne){var ee=ne.split(":"),Y=ee.shift().trim();if(Y){var ct=ee.join(":").trim();R.append(Y,ct)}}),R}we.call(Te.prototype);function ke(m,R){R||(R={}),this.type="default",this.status=R.status===void 0?200:R.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in R?R.statusText:"OK",this.headers=new F(R.headers),this.url=R.url||"",this._initBody(m)}we.call(ke.prototype),ke.prototype.clone=function(){return new ke(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new F(this.headers),url:this.url})},ke.error=function(){var m=new ke(null,{status:0,statusText:""});return m.type="error",m};var Gi=[301,302,303,307,308];ke.redirect=function(m,R){if(Gi.indexOf(R)===-1)throw new RangeError("Invalid status code");return new ke(null,{status:R,headers:{location:m}})},y.DOMException=f.DOMException;try{new y.DOMException}catch{y.DOMException=function(R,U){this.message=R,this.name=U;var ne=Error(R);this.stack=ne.stack},y.DOMException.prototype=Object.create(Error.prototype),y.DOMException.prototype.constructor=y.DOMException}function fr(m,R){return new Promise(function(U,ne){var ee=new Te(m,R);if(ee.signal&&ee.signal.aborted)return ne(new y.DOMException("Aborted","AbortError"));var Y=new XMLHttpRequest;function ct(){Y.abort()}Y.onload=function(){var Ie={status:Y.status,statusText:Y.statusText,headers:Bi(Y.getAllResponseHeaders()||"")};Ie.url="responseURL"in Y?Y.responseURL:Ie.headers.get("X-Request-URL");var dr="response"in Y?Y.response:Y.responseText;U(new ke(dr,Ie))},Y.onerror=function(){ne(new TypeError("Network request failed"))},Y.ontimeout=function(){ne(new TypeError("Network request failed"))},Y.onabort=function(){ne(new y.DOMException("Aborted","AbortError"))},Y.open(ee.method,ee.url,!0),ee.credentials==="include"?Y.withCredentials=!0:ee.credentials==="omit"&&(Y.withCredentials=!1),"responseType"in Y&&E.blob&&(Y.responseType="blob"),ee.headers.forEach(function(Ie,dr){Y.setRequestHeader(dr,Ie)}),ee.signal&&(ee.signal.addEventListener("abort",ct),Y.onreadystatechange=function(){Y.readyState===4&&ee.signal.removeEventListener("abort",ct)}),Y.send(typeof ee._bodyInit>"u"?null:ee._bodyInit)})}return fr.polyfill=!0,f.fetch||(f.fetch=fr,f.Headers=F,f.Request=Te,f.Response=ke),y.Headers=F,y.Request=Te,y.Response=ke,y.fetch=fr,Object.defineProperty(y,"__esModule",{value:!0}),y})({})})(o),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var c=o;n=c.fetch,n.default=c.fetch,n.fetch=c.fetch,n.Headers=c.Headers,n.Request=c.Request,n.Response=c.Response,P.exports=n})(Ss,Ss.exports);const Ic=am(Ss.exports),Rm={Accept:"application/json","Content-Type":"application/json"},Cm="POST",Ec={headers:Rm,method:Cm},bc=10;class Dt{constructor(n,i=!1){if(this.url=n,this.disableProviderPing=i,this.events=new Gr.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!gc(n))throw new Error(`Provided URL is not compatible with HTTP connection: ${n}`);this.url=n,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(n,i){this.events.on(n,i)}once(n,i){this.events.once(n,i)}off(n,i){this.events.off(n,i)}removeListener(n,i){this.events.removeListener(n,i)}async open(n=this.url){await this.register(n)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(n,i){this.isAvailable||await this.register();try{const o=vc(n),f=await(await Ic(this.url,Object.assign(Object.assign({},Ec),{body:o}))).json();this.onPayload({data:f})}catch(o){this.onError(n.id,o)}}async register(n=this.url){if(!gc(n))throw new Error(`Provided URL is not compatible with HTTP connection: ${n}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((o,c)=>{this.events.once("register_error",f=>{this.resetMaxListeners(),c(f)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return c(new Error("HTTP connection is missing or invalid"));o()})})}this.url=n,this.registering=!0;try{if(!this.disableProviderPing){const i=vc({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ic(n,Object.assign(Object.assign({},Ec),{body:i}))}this.onOpen()}catch(i){const o=this.parseError(i);throw this.events.emit("register_error",o),this.onClose(),o}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(n){if(typeof n.data>"u")return;const i=typeof n.data=="string"?cm(n.data):n.data;this.events.emit("payload",i)}onError(n,i){const o=this.parseError(i),c=o.message||o.toString(),f=Tc(n,c);this.events.emit("payload",f)}parseError(n,i=this.url){return um(n,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>bc&&this.events.setMaxListeners(bc)}}const Pc="error",Am="wss://relay.walletconnect.com",qm="wc",Om="universal_provider",Sc=`${qm}@2:${Om}:`,Nm="https://rpc.walletconnect.com/v1/",wt={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Vr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof mc<"u"?mc:typeof self<"u"?self:{},Rs={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(P,n){(function(){var i,o="4.17.21",c=200,f="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",y="Expected a function",E="Invalid `variable` option passed into `_.template`",S="__lodash_hash_undefined__",q=500,j="__lodash_placeholder__",M=1,H=2,J=4,F=1,Ce=2,pe=1,Ae=2,Wt=4,fe=8,ue=16,we=32,It=64,Je=128,Te=256,pr=512,Bi=30,ke="...",Gi=800,fr=16,m=1,R=2,U=3,ne=1/0,ee=9007199254740991,Y=17976931348623157e292,ct=0/0,Ie=4294967295,dr=Ie-1,Vc=Ie>>>1,Fc=[["ary",Je],["bind",pe],["bindKey",Ae],["curry",fe],["curryRight",ue],["flip",pr],["partial",we],["partialRight",It],["rearg",Te]],Kt="[object Arguments]",Wr="[object Array]",zc="[object AsyncFunction]",gr="[object Boolean]",vr="[object Date]",Bc="[object DOMException]",Kr="[object Error]",Qr="[object Function]",Ts="[object GeneratorFunction]",Ye="[object Map]",mr="[object Number]",Gc="[object Null]",ut="[object Object]",$s="[object Promise]",Wc="[object Proxy]",yr="[object RegExp]",Ze="[object Set]",_r="[object String]",Jr="[object Symbol]",Kc="[object Undefined]",wr="[object WeakMap]",Qc="[object WeakSet]",Ir="[object ArrayBuffer]",Qt="[object DataView]",Wi="[object Float32Array]",Ki="[object Float64Array]",Qi="[object Int8Array]",Ji="[object Int16Array]",Yi="[object Int32Array]",Zi="[object Uint8Array]",Xi="[object Uint8ClampedArray]",en="[object Uint16Array]",tn="[object Uint32Array]",Jc=/\b__p \+= '';/g,Yc=/\b(__p \+=) '' \+/g,Zc=/(__e\(.*?\)|\b__t\)) \+\n'';/g,js=/&(?:amp|lt|gt|quot|#39);/g,Ms=/[&<>"']/g,Xc=RegExp(js.source),eu=RegExp(Ms.source),tu=/<%-([\s\S]+?)%>/g,ru=/<%([\s\S]+?)%>/g,Ls=/<%=([\s\S]+?)%>/g,iu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nu=/^\w*$/,su=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,rn=/[\\^$.*+?()[\]{}|]/g,ou=RegExp(rn.source),nn=/^\s+/,au=/\s/,cu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,uu=/\{\n\/\* \[wrapped with (.+)\] \*/,hu=/,? & /,lu=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pu=/[()=,{}\[\]\/\s]/,fu=/\\(\\)?/g,du=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Hs=/\w*$/,gu=/^[-+]0x[0-9a-f]+$/i,vu=/^0b[01]+$/i,mu=/^\[object .+?Constructor\]$/,yu=/^0o[0-7]+$/i,_u=/^(?:0|[1-9]\d*)$/,wu=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yr=/($^)/,Iu=/['\n\r\u2028\u2029\\]/g,Zr="\\ud800-\\udfff",Eu="\\u0300-\\u036f",bu="\\ufe20-\\ufe2f",Pu="\\u20d0-\\u20ff",Us=Eu+bu+Pu,ks="\\u2700-\\u27bf",Vs="a-z\\xdf-\\xf6\\xf8-\\xff",Su="\\xac\\xb1\\xd7\\xf7",Ru="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Cu="\\u2000-\\u206f",Au=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fs="A-Z\\xc0-\\xd6\\xd8-\\xde",zs="\\ufe0e\\ufe0f",Bs=Su+Ru+Cu+Au,sn="['\u2019]",qu="["+Zr+"]",Gs="["+Bs+"]",Xr="["+Us+"]",Ws="\\d+",Ou="["+ks+"]",Ks="["+Vs+"]",Qs="[^"+Zr+Bs+Ws+ks+Vs+Fs+"]",on="\\ud83c[\\udffb-\\udfff]",Nu="(?:"+Xr+"|"+on+")",Js="[^"+Zr+"]",an="(?:\\ud83c[\\udde6-\\uddff]){2}",cn="[\\ud800-\\udbff][\\udc00-\\udfff]",Jt="["+Fs+"]",Ys="\\u200d",Zs="(?:"+Ks+"|"+Qs+")",xu="(?:"+Jt+"|"+Qs+")",Xs="(?:"+sn+"(?:d|ll|m|re|s|t|ve))?",eo="(?:"+sn+"(?:D|LL|M|RE|S|T|VE))?",to=Nu+"?",ro="["+zs+"]?",Du="(?:"+Ys+"(?:"+[Js,an,cn].join("|")+")"+ro+to+")*",Tu="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$u="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",io=ro+to+Du,ju="(?:"+[Ou,an,cn].join("|")+")"+io,Mu="(?:"+[Js+Xr+"?",Xr,an,cn,qu].join("|")+")",Lu=RegExp(sn,"g"),Hu=RegExp(Xr,"g"),un=RegExp(on+"(?="+on+")|"+Mu+io,"g"),Uu=RegExp([Jt+"?"+Ks+"+"+Xs+"(?="+[Gs,Jt,"$"].join("|")+")",xu+"+"+eo+"(?="+[Gs,Jt+Zs,"$"].join("|")+")",Jt+"?"+Zs+"+"+Xs,Jt+"+"+eo,$u,Tu,Ws,ju].join("|"),"g"),ku=RegExp("["+Ys+Zr+Us+zs+"]"),Vu=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fu=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],zu=-1,re={};re[Wi]=re[Ki]=re[Qi]=re[Ji]=re[Yi]=re[Zi]=re[Xi]=re[en]=re[tn]=!0,re[Kt]=re[Wr]=re[Ir]=re[gr]=re[Qt]=re[vr]=re[Kr]=re[Qr]=re[Ye]=re[mr]=re[ut]=re[yr]=re[Ze]=re[_r]=re[wr]=!1;var te={};te[Kt]=te[Wr]=te[Ir]=te[Qt]=te[gr]=te[vr]=te[Wi]=te[Ki]=te[Qi]=te[Ji]=te[Yi]=te[Ye]=te[mr]=te[ut]=te[yr]=te[Ze]=te[_r]=te[Jr]=te[Zi]=te[Xi]=te[en]=te[tn]=!0,te[Kr]=te[Qr]=te[wr]=!1;var Bu={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Gu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Wu={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ku={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Qu=parseFloat,Ju=parseInt,no=typeof Vr=="object"&&Vr&&Vr.Object===Object&&Vr,Yu=typeof self=="object"&&self&&self.Object===Object&&self,me=no||Yu||Function("return this")(),hn=n&&!n.nodeType&&n,Tt=hn&&!0&&P&&!P.nodeType&&P,so=Tt&&Tt.exports===hn,ln=so&&no.process,Ve=function(){try{var d=Tt&&Tt.require&&Tt.require("util").types;return d||ln&&ln.binding&&ln.binding("util")}catch{}}(),oo=Ve&&Ve.isArrayBuffer,ao=Ve&&Ve.isDate,co=Ve&&Ve.isMap,uo=Ve&&Ve.isRegExp,ho=Ve&&Ve.isSet,lo=Ve&&Ve.isTypedArray;function $e(d,_,v){switch(v.length){case 0:return d.call(_);case 1:return d.call(_,v[0]);case 2:return d.call(_,v[0],v[1]);case 3:return d.call(_,v[0],v[1],v[2])}return d.apply(_,v)}function Zu(d,_,v,A){for(var T=-1,K=d==null?0:d.length;++T<K;){var de=d[T];_(A,de,v(de),d)}return A}function Fe(d,_){for(var v=-1,A=d==null?0:d.length;++v<A&&_(d[v],v,d)!==!1;);return d}function Xu(d,_){for(var v=d==null?0:d.length;v--&&_(d[v],v,d)!==!1;);return d}function po(d,_){for(var v=-1,A=d==null?0:d.length;++v<A;)if(!_(d[v],v,d))return!1;return!0}function Et(d,_){for(var v=-1,A=d==null?0:d.length,T=0,K=[];++v<A;){var de=d[v];_(de,v,d)&&(K[T++]=de)}return K}function ei(d,_){var v=d==null?0:d.length;return!!v&&Yt(d,_,0)>-1}function pn(d,_,v){for(var A=-1,T=d==null?0:d.length;++A<T;)if(v(_,d[A]))return!0;return!1}function se(d,_){for(var v=-1,A=d==null?0:d.length,T=Array(A);++v<A;)T[v]=_(d[v],v,d);return T}function bt(d,_){for(var v=-1,A=_.length,T=d.length;++v<A;)d[T+v]=_[v];return d}function fn(d,_,v,A){var T=-1,K=d==null?0:d.length;for(A&&K&&(v=d[++T]);++T<K;)v=_(v,d[T],T,d);return v}function eh(d,_,v,A){var T=d==null?0:d.length;for(A&&T&&(v=d[--T]);T--;)v=_(v,d[T],T,d);return v}function dn(d,_){for(var v=-1,A=d==null?0:d.length;++v<A;)if(_(d[v],v,d))return!0;return!1}var th=gn("length");function rh(d){return d.split("")}function ih(d){return d.match(lu)||[]}function fo(d,_,v){var A;return v(d,function(T,K,de){if(_(T,K,de))return A=K,!1}),A}function ti(d,_,v,A){for(var T=d.length,K=v+(A?1:-1);A?K--:++K<T;)if(_(d[K],K,d))return K;return-1}function Yt(d,_,v){return _===_?gh(d,_,v):ti(d,go,v)}function nh(d,_,v,A){for(var T=v-1,K=d.length;++T<K;)if(A(d[T],_))return T;return-1}function go(d){return d!==d}function vo(d,_){var v=d==null?0:d.length;return v?mn(d,_)/v:ct}function gn(d){return function(_){return _==null?i:_[d]}}function vn(d){return function(_){return d==null?i:d[_]}}function mo(d,_,v,A,T){return T(d,function(K,de,X){v=A?(A=!1,K):_(v,K,de,X)}),v}function sh(d,_){var v=d.length;for(d.sort(_);v--;)d[v]=d[v].value;return d}function mn(d,_){for(var v,A=-1,T=d.length;++A<T;){var K=_(d[A]);K!==i&&(v=v===i?K:v+K)}return v}function yn(d,_){for(var v=-1,A=Array(d);++v<d;)A[v]=_(v);return A}function oh(d,_){return se(_,function(v){return[v,d[v]]})}function yo(d){return d&&d.slice(0,Eo(d)+1).replace(nn,"")}function je(d){return function(_){return d(_)}}function _n(d,_){return se(_,function(v){return d[v]})}function Er(d,_){return d.has(_)}function _o(d,_){for(var v=-1,A=d.length;++v<A&&Yt(_,d[v],0)>-1;);return v}function wo(d,_){for(var v=d.length;v--&&Yt(_,d[v],0)>-1;);return v}function ah(d,_){for(var v=d.length,A=0;v--;)d[v]===_&&++A;return A}var ch=vn(Bu),uh=vn(Gu);function hh(d){return"\\"+Ku[d]}function lh(d,_){return d==null?i:d[_]}function Zt(d){return ku.test(d)}function ph(d){return Vu.test(d)}function fh(d){for(var _,v=[];!(_=d.next()).done;)v.push(_.value);return v}function wn(d){var _=-1,v=Array(d.size);return d.forEach(function(A,T){v[++_]=[T,A]}),v}function Io(d,_){return function(v){return d(_(v))}}function Pt(d,_){for(var v=-1,A=d.length,T=0,K=[];++v<A;){var de=d[v];(de===_||de===j)&&(d[v]=j,K[T++]=v)}return K}function ri(d){var _=-1,v=Array(d.size);return d.forEach(function(A){v[++_]=A}),v}function dh(d){var _=-1,v=Array(d.size);return d.forEach(function(A){v[++_]=[A,A]}),v}function gh(d,_,v){for(var A=v-1,T=d.length;++A<T;)if(d[A]===_)return A;return-1}function vh(d,_,v){for(var A=v+1;A--;)if(d[A]===_)return A;return A}function Xt(d){return Zt(d)?yh(d):th(d)}function Xe(d){return Zt(d)?_h(d):rh(d)}function Eo(d){for(var _=d.length;_--&&au.test(d.charAt(_)););return _}var mh=vn(Wu);function yh(d){for(var _=un.lastIndex=0;un.test(d);)++_;return _}function _h(d){return d.match(un)||[]}function wh(d){return d.match(Uu)||[]}var Ih=function d(_){_=_==null?me:er.defaults(me.Object(),_,er.pick(me,Fu));var v=_.Array,A=_.Date,T=_.Error,K=_.Function,de=_.Math,X=_.Object,In=_.RegExp,Eh=_.String,ze=_.TypeError,ii=v.prototype,bh=K.prototype,tr=X.prototype,ni=_["__core-js_shared__"],si=bh.toString,Z=tr.hasOwnProperty,Ph=0,bo=function(){var e=/[^.]+$/.exec(ni&&ni.keys&&ni.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),oi=tr.toString,Sh=si.call(X),Rh=me._,Ch=In("^"+si.call(Z).replace(rn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ai=so?_.Buffer:i,St=_.Symbol,ci=_.Uint8Array,Po=ai?ai.allocUnsafe:i,ui=Io(X.getPrototypeOf,X),So=X.create,Ro=tr.propertyIsEnumerable,hi=ii.splice,Co=St?St.isConcatSpreadable:i,br=St?St.iterator:i,$t=St?St.toStringTag:i,li=function(){try{var e=Ut(X,"defineProperty");return e({},"",{}),e}catch{}}(),Ah=_.clearTimeout!==me.clearTimeout&&_.clearTimeout,qh=A&&A.now!==me.Date.now&&A.now,Oh=_.setTimeout!==me.setTimeout&&_.setTimeout,pi=de.ceil,fi=de.floor,En=X.getOwnPropertySymbols,Nh=ai?ai.isBuffer:i,Ao=_.isFinite,xh=ii.join,Dh=Io(X.keys,X),ge=de.max,Ee=de.min,Th=A.now,$h=_.parseInt,qo=de.random,jh=ii.reverse,bn=Ut(_,"DataView"),Pr=Ut(_,"Map"),Pn=Ut(_,"Promise"),rr=Ut(_,"Set"),Sr=Ut(_,"WeakMap"),Rr=Ut(X,"create"),di=Sr&&new Sr,ir={},Mh=kt(bn),Lh=kt(Pr),Hh=kt(Pn),Uh=kt(rr),kh=kt(Sr),gi=St?St.prototype:i,Cr=gi?gi.valueOf:i,Oo=gi?gi.toString:i;function u(e){if(ce(e)&&!$(e)&&!(e instanceof G)){if(e instanceof Be)return e;if(Z.call(e,"__wrapped__"))return Na(e)}return new Be(e)}var nr=function(){function e(){}return function(t){if(!ae(t))return{};if(So)return So(t);e.prototype=t;var r=new e;return e.prototype=i,r}}();function vi(){}function Be(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}u.templateSettings={escape:tu,evaluate:ru,interpolate:Ls,variable:"",imports:{_:u}},u.prototype=vi.prototype,u.prototype.constructor=u,Be.prototype=nr(vi.prototype),Be.prototype.constructor=Be;function G(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ie,this.__views__=[]}function Vh(){var e=new G(this.__wrapped__);return e.__actions__=qe(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=qe(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=qe(this.__views__),e}function Fh(){if(this.__filtered__){var e=new G(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function zh(){var e=this.__wrapped__.value(),t=this.__dir__,r=$(e),s=t<0,a=r?e.length:0,h=rp(0,a,this.__views__),l=h.start,p=h.end,g=p-l,w=s?p:l-1,I=this.__iteratees__,b=I.length,C=0,O=Ee(g,this.__takeCount__);if(!r||!s&&a==g&&O==g)return ea(e,this.__actions__);var x=[];e:for(;g--&&C<O;){w+=t;for(var k=-1,D=e[w];++k<b;){var B=I[k],W=B.iteratee,He=B.type,Re=W(D);if(He==R)D=Re;else if(!Re){if(He==m)continue e;break e}}x[C++]=D}return x}G.prototype=nr(vi.prototype),G.prototype.constructor=G;function jt(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function Bh(){this.__data__=Rr?Rr(null):{},this.size=0}function Gh(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Wh(e){var t=this.__data__;if(Rr){var r=t[e];return r===S?i:r}return Z.call(t,e)?t[e]:i}function Kh(e){var t=this.__data__;return Rr?t[e]!==i:Z.call(t,e)}function Qh(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Rr&&t===i?S:t,this}jt.prototype.clear=Bh,jt.prototype.delete=Gh,jt.prototype.get=Wh,jt.prototype.has=Kh,jt.prototype.set=Qh;function ht(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function Jh(){this.__data__=[],this.size=0}function Yh(e){var t=this.__data__,r=mi(t,e);if(r<0)return!1;var s=t.length-1;return r==s?t.pop():hi.call(t,r,1),--this.size,!0}function Zh(e){var t=this.__data__,r=mi(t,e);return r<0?i:t[r][1]}function Xh(e){return mi(this.__data__,e)>-1}function el(e,t){var r=this.__data__,s=mi(r,e);return s<0?(++this.size,r.push([e,t])):r[s][1]=t,this}ht.prototype.clear=Jh,ht.prototype.delete=Yh,ht.prototype.get=Zh,ht.prototype.has=Xh,ht.prototype.set=el;function lt(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function tl(){this.size=0,this.__data__={hash:new jt,map:new(Pr||ht),string:new jt}}function rl(e){var t=qi(this,e).delete(e);return this.size-=t?1:0,t}function il(e){return qi(this,e).get(e)}function nl(e){return qi(this,e).has(e)}function sl(e,t){var r=qi(this,e),s=r.size;return r.set(e,t),this.size+=r.size==s?0:1,this}lt.prototype.clear=tl,lt.prototype.delete=rl,lt.prototype.get=il,lt.prototype.has=nl,lt.prototype.set=sl;function Mt(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new lt;++t<r;)this.add(e[t])}function ol(e){return this.__data__.set(e,S),this}function al(e){return this.__data__.has(e)}Mt.prototype.add=Mt.prototype.push=ol,Mt.prototype.has=al;function et(e){var t=this.__data__=new ht(e);this.size=t.size}function cl(){this.__data__=new ht,this.size=0}function ul(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function hl(e){return this.__data__.get(e)}function ll(e){return this.__data__.has(e)}function pl(e,t){var r=this.__data__;if(r instanceof ht){var s=r.__data__;if(!Pr||s.length<c-1)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new lt(s)}return r.set(e,t),this.size=r.size,this}et.prototype.clear=cl,et.prototype.delete=ul,et.prototype.get=hl,et.prototype.has=ll,et.prototype.set=pl;function No(e,t){var r=$(e),s=!r&&Vt(e),a=!r&&!s&&Ot(e),h=!r&&!s&&!a&&cr(e),l=r||s||a||h,p=l?yn(e.length,Eh):[],g=p.length;for(var w in e)(t||Z.call(e,w))&&!(l&&(w=="length"||a&&(w=="offset"||w=="parent")||h&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||gt(w,g)))&&p.push(w);return p}function xo(e){var t=e.length;return t?e[$n(0,t-1)]:i}function fl(e,t){return Oi(qe(e),Lt(t,0,e.length))}function dl(e){return Oi(qe(e))}function Sn(e,t,r){(r!==i&&!tt(e[t],r)||r===i&&!(t in e))&&pt(e,t,r)}function Ar(e,t,r){var s=e[t];(!(Z.call(e,t)&&tt(s,r))||r===i&&!(t in e))&&pt(e,t,r)}function mi(e,t){for(var r=e.length;r--;)if(tt(e[r][0],t))return r;return-1}function gl(e,t,r,s){return Rt(e,function(a,h,l){t(s,a,r(a),l)}),s}function Do(e,t){return e&&st(t,ve(t),e)}function vl(e,t){return e&&st(t,Ne(t),e)}function pt(e,t,r){t=="__proto__"&&li?li(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Rn(e,t){for(var r=-1,s=t.length,a=v(s),h=e==null;++r<s;)a[r]=h?i:os(e,t[r]);return a}function Lt(e,t,r){return e===e&&(r!==i&&(e=e<=r?e:r),t!==i&&(e=e>=t?e:t)),e}function Ge(e,t,r,s,a,h){var l,p=t&M,g=t&H,w=t&J;if(r&&(l=a?r(e,s,a,h):r(e)),l!==i)return l;if(!ae(e))return e;var I=$(e);if(I){if(l=np(e),!p)return qe(e,l)}else{var b=be(e),C=b==Qr||b==Ts;if(Ot(e))return ia(e,p);if(b==ut||b==Kt||C&&!a){if(l=g||C?{}:Ea(e),!p)return g?Wl(e,vl(l,e)):Gl(e,Do(l,e))}else{if(!te[b])return a?e:{};l=sp(e,b,p)}}h||(h=new et);var O=h.get(e);if(O)return O;h.set(e,l),Ya(e)?e.forEach(function(D){l.add(Ge(D,t,r,D,e,h))}):Qa(e)&&e.forEach(function(D,B){l.set(B,Ge(D,t,r,B,e,h))});var x=w?g?Gn:Bn:g?Ne:ve,k=I?i:x(e);return Fe(k||e,function(D,B){k&&(B=D,D=e[B]),Ar(l,B,Ge(D,t,r,B,e,h))}),l}function ml(e){var t=ve(e);return function(r){return To(r,e,t)}}function To(e,t,r){var s=r.length;if(e==null)return!s;for(e=X(e);s--;){var a=r[s],h=t[a],l=e[a];if(l===i&&!(a in e)||!h(l))return!1}return!0}function $o(e,t,r){if(typeof e!="function")throw new ze(y);return $r(function(){e.apply(i,r)},t)}function qr(e,t,r,s){var a=-1,h=ei,l=!0,p=e.length,g=[],w=t.length;if(!p)return g;r&&(t=se(t,je(r))),s?(h=pn,l=!1):t.length>=c&&(h=Er,l=!1,t=new Mt(t));e:for(;++a<p;){var I=e[a],b=r==null?I:r(I);if(I=s||I!==0?I:0,l&&b===b){for(var C=w;C--;)if(t[C]===b)continue e;g.push(I)}else h(t,b,s)||g.push(I)}return g}var Rt=ca(nt),jo=ca(An,!0);function yl(e,t){var r=!0;return Rt(e,function(s,a,h){return r=!!t(s,a,h),r}),r}function yi(e,t,r){for(var s=-1,a=e.length;++s<a;){var h=e[s],l=t(h);if(l!=null&&(p===i?l===l&&!Le(l):r(l,p)))var p=l,g=h}return g}function _l(e,t,r,s){var a=e.length;for(r=L(r),r<0&&(r=-r>a?0:a+r),s=s===i||s>a?a:L(s),s<0&&(s+=a),s=r>s?0:Xa(s);r<s;)e[r++]=t;return e}function Mo(e,t){var r=[];return Rt(e,function(s,a,h){t(s,a,h)&&r.push(s)}),r}function ye(e,t,r,s,a){var h=-1,l=e.length;for(r||(r=ap),a||(a=[]);++h<l;){var p=e[h];t>0&&r(p)?t>1?ye(p,t-1,r,s,a):bt(a,p):s||(a[a.length]=p)}return a}var Cn=ua(),Lo=ua(!0);function nt(e,t){return e&&Cn(e,t,ve)}function An(e,t){return e&&Lo(e,t,ve)}function _i(e,t){return Et(t,function(r){return vt(e[r])})}function Ht(e,t){t=At(t,e);for(var r=0,s=t.length;e!=null&&r<s;)e=e[ot(t[r++])];return r&&r==s?e:i}function Ho(e,t,r){var s=t(e);return $(e)?s:bt(s,r(e))}function Pe(e){return e==null?e===i?Kc:Gc:$t&&$t in X(e)?tp(e):dp(e)}function qn(e,t){return e>t}function wl(e,t){return e!=null&&Z.call(e,t)}function Il(e,t){return e!=null&&t in X(e)}function El(e,t,r){return e>=Ee(t,r)&&e<ge(t,r)}function On(e,t,r){for(var s=r?pn:ei,a=e[0].length,h=e.length,l=h,p=v(h),g=1/0,w=[];l--;){var I=e[l];l&&t&&(I=se(I,je(t))),g=Ee(I.length,g),p[l]=!r&&(t||a>=120&&I.length>=120)?new Mt(l&&I):i}I=e[0];var b=-1,C=p[0];e:for(;++b<a&&w.length<g;){var O=I[b],x=t?t(O):O;if(O=r||O!==0?O:0,!(C?Er(C,x):s(w,x,r))){for(l=h;--l;){var k=p[l];if(!(k?Er(k,x):s(e[l],x,r)))continue e}C&&C.push(x),w.push(O)}}return w}function bl(e,t,r,s){return nt(e,function(a,h,l){t(s,r(a),h,l)}),s}function Or(e,t,r){t=At(t,e),e=Ra(e,t);var s=e==null?e:e[ot(Ke(t))];return s==null?i:$e(s,e,r)}function Uo(e){return ce(e)&&Pe(e)==Kt}function Pl(e){return ce(e)&&Pe(e)==Ir}function Sl(e){return ce(e)&&Pe(e)==vr}function Nr(e,t,r,s,a){return e===t?!0:e==null||t==null||!ce(e)&&!ce(t)?e!==e&&t!==t:Rl(e,t,r,s,Nr,a)}function Rl(e,t,r,s,a,h){var l=$(e),p=$(t),g=l?Wr:be(e),w=p?Wr:be(t);g=g==Kt?ut:g,w=w==Kt?ut:w;var I=g==ut,b=w==ut,C=g==w;if(C&&Ot(e)){if(!Ot(t))return!1;l=!0,I=!1}if(C&&!I)return h||(h=new et),l||cr(e)?_a(e,t,r,s,a,h):Xl(e,t,g,r,s,a,h);if(!(r&F)){var O=I&&Z.call(e,"__wrapped__"),x=b&&Z.call(t,"__wrapped__");if(O||x){var k=O?e.value():e,D=x?t.value():t;return h||(h=new et),a(k,D,r,s,h)}}return C?(h||(h=new et),ep(e,t,r,s,a,h)):!1}function Cl(e){return ce(e)&&be(e)==Ye}function Nn(e,t,r,s){var a=r.length,h=a,l=!s;if(e==null)return!h;for(e=X(e);a--;){var p=r[a];if(l&&p[2]?p[1]!==e[p[0]]:!(p[0]in e))return!1}for(;++a<h;){p=r[a];var g=p[0],w=e[g],I=p[1];if(l&&p[2]){if(w===i&&!(g in e))return!1}else{var b=new et;if(s)var C=s(w,I,g,e,t,b);if(!(C===i?Nr(I,w,F|Ce,s,b):C))return!1}}return!0}function ko(e){if(!ae(e)||up(e))return!1;var t=vt(e)?Ch:mu;return t.test(kt(e))}function Al(e){return ce(e)&&Pe(e)==yr}function ql(e){return ce(e)&&be(e)==Ze}function Ol(e){return ce(e)&&ji(e.length)&&!!re[Pe(e)]}function Vo(e){return typeof e=="function"?e:e==null?xe:typeof e=="object"?$(e)?Bo(e[0],e[1]):zo(e):hc(e)}function xn(e){if(!Tr(e))return Dh(e);var t=[];for(var r in X(e))Z.call(e,r)&&r!="constructor"&&t.push(r);return t}function Nl(e){if(!ae(e))return fp(e);var t=Tr(e),r=[];for(var s in e)s=="constructor"&&(t||!Z.call(e,s))||r.push(s);return r}function Dn(e,t){return e<t}function Fo(e,t){var r=-1,s=Oe(e)?v(e.length):[];return Rt(e,function(a,h,l){s[++r]=t(a,h,l)}),s}function zo(e){var t=Kn(e);return t.length==1&&t[0][2]?Pa(t[0][0],t[0][1]):function(r){return r===e||Nn(r,e,t)}}function Bo(e,t){return Jn(e)&&ba(t)?Pa(ot(e),t):function(r){var s=os(r,e);return s===i&&s===t?as(r,e):Nr(t,s,F|Ce)}}function wi(e,t,r,s,a){e!==t&&Cn(t,function(h,l){if(a||(a=new et),ae(h))xl(e,t,l,r,wi,s,a);else{var p=s?s(Zn(e,l),h,l+"",e,t,a):i;p===i&&(p=h),Sn(e,l,p)}},Ne)}function xl(e,t,r,s,a,h,l){var p=Zn(e,r),g=Zn(t,r),w=l.get(g);if(w){Sn(e,r,w);return}var I=h?h(p,g,r+"",e,t,l):i,b=I===i;if(b){var C=$(g),O=!C&&Ot(g),x=!C&&!O&&cr(g);I=g,C||O||x?$(p)?I=p:he(p)?I=qe(p):O?(b=!1,I=ia(g,!0)):x?(b=!1,I=na(g,!0)):I=[]:jr(g)||Vt(g)?(I=p,Vt(p)?I=ec(p):(!ae(p)||vt(p))&&(I=Ea(g))):b=!1}b&&(l.set(g,I),a(I,g,s,h,l),l.delete(g)),Sn(e,r,I)}function Go(e,t){var r=e.length;if(r)return t+=t<0?r:0,gt(t,r)?e[t]:i}function Wo(e,t,r){t.length?t=se(t,function(h){return $(h)?function(l){return Ht(l,h.length===1?h[0]:h)}:h}):t=[xe];var s=-1;t=se(t,je(N()));var a=Fo(e,function(h,l,p){var g=se(t,function(w){return w(h)});return{criteria:g,index:++s,value:h}});return sh(a,function(h,l){return Bl(h,l,r)})}function Dl(e,t){return Ko(e,t,function(r,s){return as(e,s)})}function Ko(e,t,r){for(var s=-1,a=t.length,h={};++s<a;){var l=t[s],p=Ht(e,l);r(p,l)&&xr(h,At(l,e),p)}return h}function Tl(e){return function(t){return Ht(t,e)}}function Tn(e,t,r,s){var a=s?nh:Yt,h=-1,l=t.length,p=e;for(e===t&&(t=qe(t)),r&&(p=se(e,je(r)));++h<l;)for(var g=0,w=t[h],I=r?r(w):w;(g=a(p,I,g,s))>-1;)p!==e&&hi.call(p,g,1),hi.call(e,g,1);return e}function Qo(e,t){for(var r=e?t.length:0,s=r-1;r--;){var a=t[r];if(r==s||a!==h){var h=a;gt(a)?hi.call(e,a,1):Ln(e,a)}}return e}function $n(e,t){return e+fi(qo()*(t-e+1))}function $l(e,t,r,s){for(var a=-1,h=ge(pi((t-e)/(r||1)),0),l=v(h);h--;)l[s?h:++a]=e,e+=r;return l}function jn(e,t){var r="";if(!e||t<1||t>ee)return r;do t%2&&(r+=e),t=fi(t/2),t&&(e+=e);while(t);return r}function z(e,t){return Xn(Sa(e,t,xe),e+"")}function jl(e){return xo(ur(e))}function Ml(e,t){var r=ur(e);return Oi(r,Lt(t,0,r.length))}function xr(e,t,r,s){if(!ae(e))return e;t=At(t,e);for(var a=-1,h=t.length,l=h-1,p=e;p!=null&&++a<h;){var g=ot(t[a]),w=r;if(g==="__proto__"||g==="constructor"||g==="prototype")return e;if(a!=l){var I=p[g];w=s?s(I,g,p):i,w===i&&(w=ae(I)?I:gt(t[a+1])?[]:{})}Ar(p,g,w),p=p[g]}return e}var Jo=di?function(e,t){return di.set(e,t),e}:xe,Ll=li?function(e,t){return li(e,"toString",{configurable:!0,enumerable:!1,value:us(t),writable:!0})}:xe;function Hl(e){return Oi(ur(e))}function We(e,t,r){var s=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var h=v(a);++s<a;)h[s]=e[s+t];return h}function Ul(e,t){var r;return Rt(e,function(s,a,h){return r=t(s,a,h),!r}),!!r}function Ii(e,t,r){var s=0,a=e==null?s:e.length;if(typeof t=="number"&&t===t&&a<=Vc){for(;s<a;){var h=s+a>>>1,l=e[h];l!==null&&!Le(l)&&(r?l<=t:l<t)?s=h+1:a=h}return a}return Mn(e,t,xe,r)}function Mn(e,t,r,s){var a=0,h=e==null?0:e.length;if(h===0)return 0;t=r(t);for(var l=t!==t,p=t===null,g=Le(t),w=t===i;a<h;){var I=fi((a+h)/2),b=r(e[I]),C=b!==i,O=b===null,x=b===b,k=Le(b);if(l)var D=s||x;else w?D=x&&(s||C):p?D=x&&C&&(s||!O):g?D=x&&C&&!O&&(s||!k):O||k?D=!1:D=s?b<=t:b<t;D?a=I+1:h=I}return Ee(h,dr)}function Yo(e,t){for(var r=-1,s=e.length,a=0,h=[];++r<s;){var l=e[r],p=t?t(l):l;if(!r||!tt(p,g)){var g=p;h[a++]=l===0?0:l}}return h}function Zo(e){return typeof e=="number"?e:Le(e)?ct:+e}function Me(e){if(typeof e=="string")return e;if($(e))return se(e,Me)+"";if(Le(e))return Oo?Oo.call(e):"";var t=e+"";return t=="0"&&1/e==-ne?"-0":t}function Ct(e,t,r){var s=-1,a=ei,h=e.length,l=!0,p=[],g=p;if(r)l=!1,a=pn;else if(h>=c){var w=t?null:Yl(e);if(w)return ri(w);l=!1,a=Er,g=new Mt}else g=t?[]:p;e:for(;++s<h;){var I=e[s],b=t?t(I):I;if(I=r||I!==0?I:0,l&&b===b){for(var C=g.length;C--;)if(g[C]===b)continue e;t&&g.push(b),p.push(I)}else a(g,b,r)||(g!==p&&g.push(b),p.push(I))}return p}function Ln(e,t){return t=At(t,e),e=Ra(e,t),e==null||delete e[ot(Ke(t))]}function Xo(e,t,r,s){return xr(e,t,r(Ht(e,t)),s)}function Ei(e,t,r,s){for(var a=e.length,h=s?a:-1;(s?h--:++h<a)&&t(e[h],h,e););return r?We(e,s?0:h,s?h+1:a):We(e,s?h+1:0,s?a:h)}function ea(e,t){var r=e;return r instanceof G&&(r=r.value()),fn(t,function(s,a){return a.func.apply(a.thisArg,bt([s],a.args))},r)}function Hn(e,t,r){var s=e.length;if(s<2)return s?Ct(e[0]):[];for(var a=-1,h=v(s);++a<s;)for(var l=e[a],p=-1;++p<s;)p!=a&&(h[a]=qr(h[a]||l,e[p],t,r));return Ct(ye(h,1),t,r)}function ta(e,t,r){for(var s=-1,a=e.length,h=t.length,l={};++s<a;){var p=s<h?t[s]:i;r(l,e[s],p)}return l}function Un(e){return he(e)?e:[]}function kn(e){return typeof e=="function"?e:xe}function At(e,t){return $(e)?e:Jn(e,t)?[e]:Oa(Q(e))}var kl=z;function qt(e,t,r){var s=e.length;return r=r===i?s:r,!t&&r>=s?e:We(e,t,r)}var ra=Ah||function(e){return me.clearTimeout(e)};function ia(e,t){if(t)return e.slice();var r=e.length,s=Po?Po(r):new e.constructor(r);return e.copy(s),s}function Vn(e){var t=new e.constructor(e.byteLength);return new ci(t).set(new ci(e)),t}function Vl(e,t){var r=t?Vn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}function Fl(e){var t=new e.constructor(e.source,Hs.exec(e));return t.lastIndex=e.lastIndex,t}function zl(e){return Cr?X(Cr.call(e)):{}}function na(e,t){var r=t?Vn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function sa(e,t){if(e!==t){var r=e!==i,s=e===null,a=e===e,h=Le(e),l=t!==i,p=t===null,g=t===t,w=Le(t);if(!p&&!w&&!h&&e>t||h&&l&&g&&!p&&!w||s&&l&&g||!r&&g||!a)return 1;if(!s&&!h&&!w&&e<t||w&&r&&a&&!s&&!h||p&&r&&a||!l&&a||!g)return-1}return 0}function Bl(e,t,r){for(var s=-1,a=e.criteria,h=t.criteria,l=a.length,p=r.length;++s<l;){var g=sa(a[s],h[s]);if(g){if(s>=p)return g;var w=r[s];return g*(w=="desc"?-1:1)}}return e.index-t.index}function oa(e,t,r,s){for(var a=-1,h=e.length,l=r.length,p=-1,g=t.length,w=ge(h-l,0),I=v(g+w),b=!s;++p<g;)I[p]=t[p];for(;++a<l;)(b||a<h)&&(I[r[a]]=e[a]);for(;w--;)I[p++]=e[a++];return I}function aa(e,t,r,s){for(var a=-1,h=e.length,l=-1,p=r.length,g=-1,w=t.length,I=ge(h-p,0),b=v(I+w),C=!s;++a<I;)b[a]=e[a];for(var O=a;++g<w;)b[O+g]=t[g];for(;++l<p;)(C||a<h)&&(b[O+r[l]]=e[a++]);return b}function qe(e,t){var r=-1,s=e.length;for(t||(t=v(s));++r<s;)t[r]=e[r];return t}function st(e,t,r,s){var a=!r;r||(r={});for(var h=-1,l=t.length;++h<l;){var p=t[h],g=s?s(r[p],e[p],p,r,e):i;g===i&&(g=e[p]),a?pt(r,p,g):Ar(r,p,g)}return r}function Gl(e,t){return st(e,Qn(e),t)}function Wl(e,t){return st(e,wa(e),t)}function bi(e,t){return function(r,s){var a=$(r)?Zu:gl,h=t?t():{};return a(r,e,N(s,2),h)}}function sr(e){return z(function(t,r){var s=-1,a=r.length,h=a>1?r[a-1]:i,l=a>2?r[2]:i;for(h=e.length>3&&typeof h=="function"?(a--,h):i,l&&Se(r[0],r[1],l)&&(h=a<3?i:h,a=1),t=X(t);++s<a;){var p=r[s];p&&e(t,p,s,h)}return t})}function ca(e,t){return function(r,s){if(r==null)return r;if(!Oe(r))return e(r,s);for(var a=r.length,h=t?a:-1,l=X(r);(t?h--:++h<a)&&s(l[h],h,l)!==!1;);return r}}function ua(e){return function(t,r,s){for(var a=-1,h=X(t),l=s(t),p=l.length;p--;){var g=l[e?p:++a];if(r(h[g],g,h)===!1)break}return t}}function Kl(e,t,r){var s=t&pe,a=Dr(e);function h(){var l=this&&this!==me&&this instanceof h?a:e;return l.apply(s?r:this,arguments)}return h}function ha(e){return function(t){t=Q(t);var r=Zt(t)?Xe(t):i,s=r?r[0]:t.charAt(0),a=r?qt(r,1).join(""):t.slice(1);return s[e]()+a}}function or(e){return function(t){return fn(cc(ac(t).replace(Lu,"")),e,"")}}function Dr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=nr(e.prototype),s=e.apply(r,t);return ae(s)?s:r}}function Ql(e,t,r){var s=Dr(e);function a(){for(var h=arguments.length,l=v(h),p=h,g=ar(a);p--;)l[p]=arguments[p];var w=h<3&&l[0]!==g&&l[h-1]!==g?[]:Pt(l,g);if(h-=w.length,h<r)return ga(e,t,Pi,a.placeholder,i,l,w,i,i,r-h);var I=this&&this!==me&&this instanceof a?s:e;return $e(I,this,l)}return a}function la(e){return function(t,r,s){var a=X(t);if(!Oe(t)){var h=N(r,3);t=ve(t),r=function(p){return h(a[p],p,a)}}var l=e(t,r,s);return l>-1?a[h?t[l]:l]:i}}function pa(e){return dt(function(t){var r=t.length,s=r,a=Be.prototype.thru;for(e&&t.reverse();s--;){var h=t[s];if(typeof h!="function")throw new ze(y);if(a&&!l&&Ai(h)=="wrapper")var l=new Be([],!0)}for(s=l?s:r;++s<r;){h=t[s];var p=Ai(h),g=p=="wrapper"?Wn(h):i;g&&Yn(g[0])&&g[1]==(Je|fe|we|Te)&&!g[4].length&&g[9]==1?l=l[Ai(g[0])].apply(l,g[3]):l=h.length==1&&Yn(h)?l[p]():l.thru(h)}return function(){var w=arguments,I=w[0];if(l&&w.length==1&&$(I))return l.plant(I).value();for(var b=0,C=r?t[b].apply(this,w):I;++b<r;)C=t[b].call(this,C);return C}})}function Pi(e,t,r,s,a,h,l,p,g,w){var I=t&Je,b=t&pe,C=t&Ae,O=t&(fe|ue),x=t&pr,k=C?i:Dr(e);function D(){for(var B=arguments.length,W=v(B),He=B;He--;)W[He]=arguments[He];if(O)var Re=ar(D),Ue=ah(W,Re);if(s&&(W=oa(W,s,a,O)),h&&(W=aa(W,h,l,O)),B-=Ue,O&&B<w){var le=Pt(W,Re);return ga(e,t,Pi,D.placeholder,r,W,le,p,g,w-B)}var rt=b?r:this,yt=C?rt[e]:e;return B=W.length,p?W=gp(W,p):x&&B>1&&W.reverse(),I&&g<B&&(W.length=g),this&&this!==me&&this instanceof D&&(yt=k||Dr(yt)),yt.apply(rt,W)}return D}function fa(e,t){return function(r,s){return bl(r,e,t(s),{})}}function Si(e,t){return function(r,s){var a;if(r===i&&s===i)return t;if(r!==i&&(a=r),s!==i){if(a===i)return s;typeof r=="string"||typeof s=="string"?(r=Me(r),s=Me(s)):(r=Zo(r),s=Zo(s)),a=e(r,s)}return a}}function Fn(e){return dt(function(t){return t=se(t,je(N())),z(function(r){var s=this;return e(t,function(a){return $e(a,s,r)})})})}function Ri(e,t){t=t===i?" ":Me(t);var r=t.length;if(r<2)return r?jn(t,e):t;var s=jn(t,pi(e/Xt(t)));return Zt(t)?qt(Xe(s),0,e).join(""):s.slice(0,e)}function Jl(e,t,r,s){var a=t&pe,h=Dr(e);function l(){for(var p=-1,g=arguments.length,w=-1,I=s.length,b=v(I+g),C=this&&this!==me&&this instanceof l?h:e;++w<I;)b[w]=s[w];for(;g--;)b[w++]=arguments[++p];return $e(C,a?r:this,b)}return l}function da(e){return function(t,r,s){return s&&typeof s!="number"&&Se(t,r,s)&&(r=s=i),t=mt(t),r===i?(r=t,t=0):r=mt(r),s=s===i?t<r?1:-1:mt(s),$l(t,r,s,e)}}function Ci(e){return function(t,r){return typeof t=="string"&&typeof r=="string"||(t=Qe(t),r=Qe(r)),e(t,r)}}function ga(e,t,r,s,a,h,l,p,g,w){var I=t&fe,b=I?l:i,C=I?i:l,O=I?h:i,x=I?i:h;t|=I?we:It,t&=~(I?It:we),t&Wt||(t&=~(pe|Ae));var k=[e,t,a,O,b,x,C,p,g,w],D=r.apply(i,k);return Yn(e)&&Ca(D,k),D.placeholder=s,Aa(D,e,t)}function zn(e){var t=de[e];return function(r,s){if(r=Qe(r),s=s==null?0:Ee(L(s),292),s&&Ao(r)){var a=(Q(r)+"e").split("e"),h=t(a[0]+"e"+(+a[1]+s));return a=(Q(h)+"e").split("e"),+(a[0]+"e"+(+a[1]-s))}return t(r)}}var Yl=rr&&1/ri(new rr([,-0]))[1]==ne?function(e){return new rr(e)}:ps;function va(e){return function(t){var r=be(t);return r==Ye?wn(t):r==Ze?dh(t):oh(t,e(t))}}function ft(e,t,r,s,a,h,l,p){var g=t&Ae;if(!g&&typeof e!="function")throw new ze(y);var w=s?s.length:0;if(w||(t&=~(we|It),s=a=i),l=l===i?l:ge(L(l),0),p=p===i?p:L(p),w-=a?a.length:0,t&It){var I=s,b=a;s=a=i}var C=g?i:Wn(e),O=[e,t,r,s,a,I,b,h,l,p];if(C&&pp(O,C),e=O[0],t=O[1],r=O[2],s=O[3],a=O[4],p=O[9]=O[9]===i?g?0:e.length:ge(O[9]-w,0),!p&&t&(fe|ue)&&(t&=~(fe|ue)),!t||t==pe)var x=Kl(e,t,r);else t==fe||t==ue?x=Ql(e,t,p):(t==we||t==(pe|we))&&!a.length?x=Jl(e,t,r,s):x=Pi.apply(i,O);var k=C?Jo:Ca;return Aa(k(x,O),e,t)}function ma(e,t,r,s){return e===i||tt(e,tr[r])&&!Z.call(s,r)?t:e}function ya(e,t,r,s,a,h){return ae(e)&&ae(t)&&(h.set(t,e),wi(e,t,i,ya,h),h.delete(t)),e}function Zl(e){return jr(e)?i:e}function _a(e,t,r,s,a,h){var l=r&F,p=e.length,g=t.length;if(p!=g&&!(l&&g>p))return!1;var w=h.get(e),I=h.get(t);if(w&&I)return w==t&&I==e;var b=-1,C=!0,O=r&Ce?new Mt:i;for(h.set(e,t),h.set(t,e);++b<p;){var x=e[b],k=t[b];if(s)var D=l?s(k,x,b,t,e,h):s(x,k,b,e,t,h);if(D!==i){if(D)continue;C=!1;break}if(O){if(!dn(t,function(B,W){if(!Er(O,W)&&(x===B||a(x,B,r,s,h)))return O.push(W)})){C=!1;break}}else if(!(x===k||a(x,k,r,s,h))){C=!1;break}}return h.delete(e),h.delete(t),C}function Xl(e,t,r,s,a,h,l){switch(r){case Qt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ir:return!(e.byteLength!=t.byteLength||!h(new ci(e),new ci(t)));case gr:case vr:case mr:return tt(+e,+t);case Kr:return e.name==t.name&&e.message==t.message;case yr:case _r:return e==t+"";case Ye:var p=wn;case Ze:var g=s&F;if(p||(p=ri),e.size!=t.size&&!g)return!1;var w=l.get(e);if(w)return w==t;s|=Ce,l.set(e,t);var I=_a(p(e),p(t),s,a,h,l);return l.delete(e),I;case Jr:if(Cr)return Cr.call(e)==Cr.call(t)}return!1}function ep(e,t,r,s,a,h){var l=r&F,p=Bn(e),g=p.length,w=Bn(t),I=w.length;if(g!=I&&!l)return!1;for(var b=g;b--;){var C=p[b];if(!(l?C in t:Z.call(t,C)))return!1}var O=h.get(e),x=h.get(t);if(O&&x)return O==t&&x==e;var k=!0;h.set(e,t),h.set(t,e);for(var D=l;++b<g;){C=p[b];var B=e[C],W=t[C];if(s)var He=l?s(W,B,C,t,e,h):s(B,W,C,e,t,h);if(!(He===i?B===W||a(B,W,r,s,h):He)){k=!1;break}D||(D=C=="constructor")}if(k&&!D){var Re=e.constructor,Ue=t.constructor;Re!=Ue&&"constructor"in e&&"constructor"in t&&!(typeof Re=="function"&&Re instanceof Re&&typeof Ue=="function"&&Ue instanceof Ue)&&(k=!1)}return h.delete(e),h.delete(t),k}function dt(e){return Xn(Sa(e,i,Ta),e+"")}function Bn(e){return Ho(e,ve,Qn)}function Gn(e){return Ho(e,Ne,wa)}var Wn=di?function(e){return di.get(e)}:ps;function Ai(e){for(var t=e.name+"",r=ir[t],s=Z.call(ir,t)?r.length:0;s--;){var a=r[s],h=a.func;if(h==null||h==e)return a.name}return t}function ar(e){var t=Z.call(u,"placeholder")?u:e;return t.placeholder}function N(){var e=u.iteratee||hs;return e=e===hs?Vo:e,arguments.length?e(arguments[0],arguments[1]):e}function qi(e,t){var r=e.__data__;return cp(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Kn(e){for(var t=ve(e),r=t.length;r--;){var s=t[r],a=e[s];t[r]=[s,a,ba(a)]}return t}function Ut(e,t){var r=lh(e,t);return ko(r)?r:i}function tp(e){var t=Z.call(e,$t),r=e[$t];try{e[$t]=i;var s=!0}catch{}var a=oi.call(e);return s&&(t?e[$t]=r:delete e[$t]),a}var Qn=En?function(e){return e==null?[]:(e=X(e),Et(En(e),function(t){return Ro.call(e,t)}))}:fs,wa=En?function(e){for(var t=[];e;)bt(t,Qn(e)),e=ui(e);return t}:fs,be=Pe;(bn&&be(new bn(new ArrayBuffer(1)))!=Qt||Pr&&be(new Pr)!=Ye||Pn&&be(Pn.resolve())!=$s||rr&&be(new rr)!=Ze||Sr&&be(new Sr)!=wr)&&(be=function(e){var t=Pe(e),r=t==ut?e.constructor:i,s=r?kt(r):"";if(s)switch(s){case Mh:return Qt;case Lh:return Ye;case Hh:return $s;case Uh:return Ze;case kh:return wr}return t});function rp(e,t,r){for(var s=-1,a=r.length;++s<a;){var h=r[s],l=h.size;switch(h.type){case"drop":e+=l;break;case"dropRight":t-=l;break;case"take":t=Ee(t,e+l);break;case"takeRight":e=ge(e,t-l);break}}return{start:e,end:t}}function ip(e){var t=e.match(uu);return t?t[1].split(hu):[]}function Ia(e,t,r){t=At(t,e);for(var s=-1,a=t.length,h=!1;++s<a;){var l=ot(t[s]);if(!(h=e!=null&&r(e,l)))break;e=e[l]}return h||++s!=a?h:(a=e==null?0:e.length,!!a&&ji(a)&&gt(l,a)&&($(e)||Vt(e)))}function np(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Z.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function Ea(e){return typeof e.constructor=="function"&&!Tr(e)?nr(ui(e)):{}}function sp(e,t,r){var s=e.constructor;switch(t){case Ir:return Vn(e);case gr:case vr:return new s(+e);case Qt:return Vl(e,r);case Wi:case Ki:case Qi:case Ji:case Yi:case Zi:case Xi:case en:case tn:return na(e,r);case Ye:return new s;case mr:case _r:return new s(e);case yr:return Fl(e);case Ze:return new s;case Jr:return zl(e)}}function op(e,t){var r=t.length;if(!r)return e;var s=r-1;return t[s]=(r>1?"& ":"")+t[s],t=t.join(r>2?", ":" "),e.replace(cu,`{
/* [wrapped with `+t+`] */
`)}function ap(e){return $(e)||Vt(e)||!!(Co&&e&&e[Co])}function gt(e,t){var r=typeof e;return t=t!=null?t:ee,!!t&&(r=="number"||r!="symbol"&&_u.test(e))&&e>-1&&e%1==0&&e<t}function Se(e,t,r){if(!ae(r))return!1;var s=typeof t;return(s=="number"?Oe(r)&&gt(t,r.length):s=="string"&&t in r)?tt(r[t],e):!1}function Jn(e,t){if($(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Le(e)?!0:nu.test(e)||!iu.test(e)||t!=null&&e in X(t)}function cp(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Yn(e){var t=Ai(e),r=u[t];if(typeof r!="function"||!(t in G.prototype))return!1;if(e===r)return!0;var s=Wn(r);return!!s&&e===s[0]}function up(e){return!!bo&&bo in e}var hp=ni?vt:ds;function Tr(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||tr;return e===r}function ba(e){return e===e&&!ae(e)}function Pa(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==i||e in X(r))}}function lp(e){var t=Ti(e,function(s){return r.size===q&&r.clear(),s}),r=t.cache;return t}function pp(e,t){var r=e[1],s=t[1],a=r|s,h=a<(pe|Ae|Je),l=s==Je&&r==fe||s==Je&&r==Te&&e[7].length<=t[8]||s==(Je|Te)&&t[7].length<=t[8]&&r==fe;if(!(h||l))return e;s&pe&&(e[2]=t[2],a|=r&pe?0:Wt);var p=t[3];if(p){var g=e[3];e[3]=g?oa(g,p,t[4]):p,e[4]=g?Pt(e[3],j):t[4]}return p=t[5],p&&(g=e[5],e[5]=g?aa(g,p,t[6]):p,e[6]=g?Pt(e[5],j):t[6]),p=t[7],p&&(e[7]=p),s&Je&&(e[8]=e[8]==null?t[8]:Ee(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e}function fp(e){var t=[];if(e!=null)for(var r in X(e))t.push(r);return t}function dp(e){return oi.call(e)}function Sa(e,t,r){return t=ge(t===i?e.length-1:t,0),function(){for(var s=arguments,a=-1,h=ge(s.length-t,0),l=v(h);++a<h;)l[a]=s[t+a];a=-1;for(var p=v(t+1);++a<t;)p[a]=s[a];return p[t]=r(l),$e(e,this,p)}}function Ra(e,t){return t.length<2?e:Ht(e,We(t,0,-1))}function gp(e,t){for(var r=e.length,s=Ee(t.length,r),a=qe(e);s--;){var h=t[s];e[s]=gt(h,r)?a[h]:i}return e}function Zn(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Ca=qa(Jo),$r=Oh||function(e,t){return me.setTimeout(e,t)},Xn=qa(Ll);function Aa(e,t,r){var s=t+"";return Xn(e,op(s,vp(ip(s),r)))}function qa(e){var t=0,r=0;return function(){var s=Th(),a=fr-(s-r);if(r=s,a>0){if(++t>=Gi)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Oi(e,t){var r=-1,s=e.length,a=s-1;for(t=t===i?s:t;++r<t;){var h=$n(r,a),l=e[h];e[h]=e[r],e[r]=l}return e.length=t,e}var Oa=lp(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(su,function(r,s,a,h){t.push(a?h.replace(fu,"$1"):s||r)}),t});function ot(e){if(typeof e=="string"||Le(e))return e;var t=e+"";return t=="0"&&1/e==-ne?"-0":t}function kt(e){if(e!=null){try{return si.call(e)}catch{}try{return e+""}catch{}}return""}function vp(e,t){return Fe(Fc,function(r){var s="_."+r[0];t&r[1]&&!ei(e,s)&&e.push(s)}),e.sort()}function Na(e){if(e instanceof G)return e.clone();var t=new Be(e.__wrapped__,e.__chain__);return t.__actions__=qe(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function mp(e,t,r){(r?Se(e,t,r):t===i)?t=1:t=ge(L(t),0);var s=e==null?0:e.length;if(!s||t<1)return[];for(var a=0,h=0,l=v(pi(s/t));a<s;)l[h++]=We(e,a,a+=t);return l}function yp(e){for(var t=-1,r=e==null?0:e.length,s=0,a=[];++t<r;){var h=e[t];h&&(a[s++]=h)}return a}function _p(){var e=arguments.length;if(!e)return[];for(var t=v(e-1),r=arguments[0],s=e;s--;)t[s-1]=arguments[s];return bt($(r)?qe(r):[r],ye(t,1))}var wp=z(function(e,t){return he(e)?qr(e,ye(t,1,he,!0)):[]}),Ip=z(function(e,t){var r=Ke(t);return he(r)&&(r=i),he(e)?qr(e,ye(t,1,he,!0),N(r,2)):[]}),Ep=z(function(e,t){var r=Ke(t);return he(r)&&(r=i),he(e)?qr(e,ye(t,1,he,!0),i,r):[]});function bp(e,t,r){var s=e==null?0:e.length;return s?(t=r||t===i?1:L(t),We(e,t<0?0:t,s)):[]}function Pp(e,t,r){var s=e==null?0:e.length;return s?(t=r||t===i?1:L(t),t=s-t,We(e,0,t<0?0:t)):[]}function Sp(e,t){return e&&e.length?Ei(e,N(t,3),!0,!0):[]}function Rp(e,t){return e&&e.length?Ei(e,N(t,3),!0):[]}function Cp(e,t,r,s){var a=e==null?0:e.length;return a?(r&&typeof r!="number"&&Se(e,t,r)&&(r=0,s=a),_l(e,t,r,s)):[]}function xa(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=r==null?0:L(r);return a<0&&(a=ge(s+a,0)),ti(e,N(t,3),a)}function Da(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=s-1;return r!==i&&(a=L(r),a=r<0?ge(s+a,0):Ee(a,s-1)),ti(e,N(t,3),a,!0)}function Ta(e){var t=e==null?0:e.length;return t?ye(e,1):[]}function Ap(e){var t=e==null?0:e.length;return t?ye(e,ne):[]}function qp(e,t){var r=e==null?0:e.length;return r?(t=t===i?1:L(t),ye(e,t)):[]}function Op(e){for(var t=-1,r=e==null?0:e.length,s={};++t<r;){var a=e[t];s[a[0]]=a[1]}return s}function $a(e){return e&&e.length?e[0]:i}function Np(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=r==null?0:L(r);return a<0&&(a=ge(s+a,0)),Yt(e,t,a)}function xp(e){var t=e==null?0:e.length;return t?We(e,0,-1):[]}var Dp=z(function(e){var t=se(e,Un);return t.length&&t[0]===e[0]?On(t):[]}),Tp=z(function(e){var t=Ke(e),r=se(e,Un);return t===Ke(r)?t=i:r.pop(),r.length&&r[0]===e[0]?On(r,N(t,2)):[]}),$p=z(function(e){var t=Ke(e),r=se(e,Un);return t=typeof t=="function"?t:i,t&&r.pop(),r.length&&r[0]===e[0]?On(r,i,t):[]});function jp(e,t){return e==null?"":xh.call(e,t)}function Ke(e){var t=e==null?0:e.length;return t?e[t-1]:i}function Mp(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=s;return r!==i&&(a=L(r),a=a<0?ge(s+a,0):Ee(a,s-1)),t===t?vh(e,t,a):ti(e,go,a,!0)}function Lp(e,t){return e&&e.length?Go(e,L(t)):i}var Hp=z(ja);function ja(e,t){return e&&e.length&&t&&t.length?Tn(e,t):e}function Up(e,t,r){return e&&e.length&&t&&t.length?Tn(e,t,N(r,2)):e}function kp(e,t,r){return e&&e.length&&t&&t.length?Tn(e,t,i,r):e}var Vp=dt(function(e,t){var r=e==null?0:e.length,s=Rn(e,t);return Qo(e,se(t,function(a){return gt(a,r)?+a:a}).sort(sa)),s});function Fp(e,t){var r=[];if(!(e&&e.length))return r;var s=-1,a=[],h=e.length;for(t=N(t,3);++s<h;){var l=e[s];t(l,s,e)&&(r.push(l),a.push(s))}return Qo(e,a),r}function es(e){return e==null?e:jh.call(e)}function zp(e,t,r){var s=e==null?0:e.length;return s?(r&&typeof r!="number"&&Se(e,t,r)?(t=0,r=s):(t=t==null?0:L(t),r=r===i?s:L(r)),We(e,t,r)):[]}function Bp(e,t){return Ii(e,t)}function Gp(e,t,r){return Mn(e,t,N(r,2))}function Wp(e,t){var r=e==null?0:e.length;if(r){var s=Ii(e,t);if(s<r&&tt(e[s],t))return s}return-1}function Kp(e,t){return Ii(e,t,!0)}function Qp(e,t,r){return Mn(e,t,N(r,2),!0)}function Jp(e,t){var r=e==null?0:e.length;if(r){var s=Ii(e,t,!0)-1;if(tt(e[s],t))return s}return-1}function Yp(e){return e&&e.length?Yo(e):[]}function Zp(e,t){return e&&e.length?Yo(e,N(t,2)):[]}function Xp(e){var t=e==null?0:e.length;return t?We(e,1,t):[]}function ef(e,t,r){return e&&e.length?(t=r||t===i?1:L(t),We(e,0,t<0?0:t)):[]}function tf(e,t,r){var s=e==null?0:e.length;return s?(t=r||t===i?1:L(t),t=s-t,We(e,t<0?0:t,s)):[]}function rf(e,t){return e&&e.length?Ei(e,N(t,3),!1,!0):[]}function nf(e,t){return e&&e.length?Ei(e,N(t,3)):[]}var sf=z(function(e){return Ct(ye(e,1,he,!0))}),of=z(function(e){var t=Ke(e);return he(t)&&(t=i),Ct(ye(e,1,he,!0),N(t,2))}),af=z(function(e){var t=Ke(e);return t=typeof t=="function"?t:i,Ct(ye(e,1,he,!0),i,t)});function cf(e){return e&&e.length?Ct(e):[]}function uf(e,t){return e&&e.length?Ct(e,N(t,2)):[]}function hf(e,t){return t=typeof t=="function"?t:i,e&&e.length?Ct(e,i,t):[]}function ts(e){if(!(e&&e.length))return[];var t=0;return e=Et(e,function(r){if(he(r))return t=ge(r.length,t),!0}),yn(t,function(r){return se(e,gn(r))})}function Ma(e,t){if(!(e&&e.length))return[];var r=ts(e);return t==null?r:se(r,function(s){return $e(t,i,s)})}var lf=z(function(e,t){return he(e)?qr(e,t):[]}),pf=z(function(e){return Hn(Et(e,he))}),ff=z(function(e){var t=Ke(e);return he(t)&&(t=i),Hn(Et(e,he),N(t,2))}),df=z(function(e){var t=Ke(e);return t=typeof t=="function"?t:i,Hn(Et(e,he),i,t)}),gf=z(ts);function vf(e,t){return ta(e||[],t||[],Ar)}function mf(e,t){return ta(e||[],t||[],xr)}var yf=z(function(e){var t=e.length,r=t>1?e[t-1]:i;return r=typeof r=="function"?(e.pop(),r):i,Ma(e,r)});function La(e){var t=u(e);return t.__chain__=!0,t}function _f(e,t){return t(e),e}function Ni(e,t){return t(e)}var wf=dt(function(e){var t=e.length,r=t?e[0]:0,s=this.__wrapped__,a=function(h){return Rn(h,e)};return t>1||this.__actions__.length||!(s instanceof G)||!gt(r)?this.thru(a):(s=s.slice(r,+r+(t?1:0)),s.__actions__.push({func:Ni,args:[a],thisArg:i}),new Be(s,this.__chain__).thru(function(h){return t&&!h.length&&h.push(i),h}))});function If(){return La(this)}function Ef(){return new Be(this.value(),this.__chain__)}function bf(){this.__values__===i&&(this.__values__=Za(this.value()));var e=this.__index__>=this.__values__.length,t=e?i:this.__values__[this.__index__++];return{done:e,value:t}}function Pf(){return this}function Sf(e){for(var t,r=this;r instanceof vi;){var s=Na(r);s.__index__=0,s.__values__=i,t?a.__wrapped__=s:t=s;var a=s;r=r.__wrapped__}return a.__wrapped__=e,t}function Rf(){var e=this.__wrapped__;if(e instanceof G){var t=e;return this.__actions__.length&&(t=new G(this)),t=t.reverse(),t.__actions__.push({func:Ni,args:[es],thisArg:i}),new Be(t,this.__chain__)}return this.thru(es)}function Cf(){return ea(this.__wrapped__,this.__actions__)}var Af=bi(function(e,t,r){Z.call(e,r)?++e[r]:pt(e,r,1)});function qf(e,t,r){var s=$(e)?po:yl;return r&&Se(e,t,r)&&(t=i),s(e,N(t,3))}function Of(e,t){var r=$(e)?Et:Mo;return r(e,N(t,3))}var Nf=la(xa),xf=la(Da);function Df(e,t){return ye(xi(e,t),1)}function Tf(e,t){return ye(xi(e,t),ne)}function $f(e,t,r){return r=r===i?1:L(r),ye(xi(e,t),r)}function Ha(e,t){var r=$(e)?Fe:Rt;return r(e,N(t,3))}function Ua(e,t){var r=$(e)?Xu:jo;return r(e,N(t,3))}var jf=bi(function(e,t,r){Z.call(e,r)?e[r].push(t):pt(e,r,[t])});function Mf(e,t,r,s){e=Oe(e)?e:ur(e),r=r&&!s?L(r):0;var a=e.length;return r<0&&(r=ge(a+r,0)),Mi(e)?r<=a&&e.indexOf(t,r)>-1:!!a&&Yt(e,t,r)>-1}var Lf=z(function(e,t,r){var s=-1,a=typeof t=="function",h=Oe(e)?v(e.length):[];return Rt(e,function(l){h[++s]=a?$e(t,l,r):Or(l,t,r)}),h}),Hf=bi(function(e,t,r){pt(e,r,t)});function xi(e,t){var r=$(e)?se:Fo;return r(e,N(t,3))}function Uf(e,t,r,s){return e==null?[]:($(t)||(t=t==null?[]:[t]),r=s?i:r,$(r)||(r=r==null?[]:[r]),Wo(e,t,r))}var kf=bi(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]});function Vf(e,t,r){var s=$(e)?fn:mo,a=arguments.length<3;return s(e,N(t,4),r,a,Rt)}function Ff(e,t,r){var s=$(e)?eh:mo,a=arguments.length<3;return s(e,N(t,4),r,a,jo)}function zf(e,t){var r=$(e)?Et:Mo;return r(e,$i(N(t,3)))}function Bf(e){var t=$(e)?xo:jl;return t(e)}function Gf(e,t,r){(r?Se(e,t,r):t===i)?t=1:t=L(t);var s=$(e)?fl:Ml;return s(e,t)}function Wf(e){var t=$(e)?dl:Hl;return t(e)}function Kf(e){if(e==null)return 0;if(Oe(e))return Mi(e)?Xt(e):e.length;var t=be(e);return t==Ye||t==Ze?e.size:xn(e).length}function Qf(e,t,r){var s=$(e)?dn:Ul;return r&&Se(e,t,r)&&(t=i),s(e,N(t,3))}var Jf=z(function(e,t){if(e==null)return[];var r=t.length;return r>1&&Se(e,t[0],t[1])?t=[]:r>2&&Se(t[0],t[1],t[2])&&(t=[t[0]]),Wo(e,ye(t,1),[])}),Di=qh||function(){return me.Date.now()};function Yf(e,t){if(typeof t!="function")throw new ze(y);return e=L(e),function(){if(--e<1)return t.apply(this,arguments)}}function ka(e,t,r){return t=r?i:t,t=e&&t==null?e.length:t,ft(e,Je,i,i,i,i,t)}function Va(e,t){var r;if(typeof t!="function")throw new ze(y);return e=L(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=i),r}}var rs=z(function(e,t,r){var s=pe;if(r.length){var a=Pt(r,ar(rs));s|=we}return ft(e,s,t,r,a)}),Fa=z(function(e,t,r){var s=pe|Ae;if(r.length){var a=Pt(r,ar(Fa));s|=we}return ft(t,s,e,r,a)});function za(e,t,r){t=r?i:t;var s=ft(e,fe,i,i,i,i,i,t);return s.placeholder=za.placeholder,s}function Ba(e,t,r){t=r?i:t;var s=ft(e,ue,i,i,i,i,i,t);return s.placeholder=Ba.placeholder,s}function Ga(e,t,r){var s,a,h,l,p,g,w=0,I=!1,b=!1,C=!0;if(typeof e!="function")throw new ze(y);t=Qe(t)||0,ae(r)&&(I=!!r.leading,b="maxWait"in r,h=b?ge(Qe(r.maxWait)||0,t):h,C="trailing"in r?!!r.trailing:C);function O(le){var rt=s,yt=a;return s=a=i,w=le,l=e.apply(yt,rt),l}function x(le){return w=le,p=$r(B,t),I?O(le):l}function k(le){var rt=le-g,yt=le-w,lc=t-rt;return b?Ee(lc,h-yt):lc}function D(le){var rt=le-g,yt=le-w;return g===i||rt>=t||rt<0||b&&yt>=h}function B(){var le=Di();if(D(le))return W(le);p=$r(B,k(le))}function W(le){return p=i,C&&s?O(le):(s=a=i,l)}function He(){p!==i&&ra(p),w=0,s=g=a=p=i}function Re(){return p===i?l:W(Di())}function Ue(){var le=Di(),rt=D(le);if(s=arguments,a=this,g=le,rt){if(p===i)return x(g);if(b)return ra(p),p=$r(B,t),O(g)}return p===i&&(p=$r(B,t)),l}return Ue.cancel=He,Ue.flush=Re,Ue}var Zf=z(function(e,t){return $o(e,1,t)}),Xf=z(function(e,t,r){return $o(e,Qe(t)||0,r)});function ed(e){return ft(e,pr)}function Ti(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new ze(y);var r=function(){var s=arguments,a=t?t.apply(this,s):s[0],h=r.cache;if(h.has(a))return h.get(a);var l=e.apply(this,s);return r.cache=h.set(a,l)||h,l};return r.cache=new(Ti.Cache||lt),r}Ti.Cache=lt;function $i(e){if(typeof e!="function")throw new ze(y);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function td(e){return Va(2,e)}var rd=kl(function(e,t){t=t.length==1&&$(t[0])?se(t[0],je(N())):se(ye(t,1),je(N()));var r=t.length;return z(function(s){for(var a=-1,h=Ee(s.length,r);++a<h;)s[a]=t[a].call(this,s[a]);return $e(e,this,s)})}),is=z(function(e,t){var r=Pt(t,ar(is));return ft(e,we,i,t,r)}),Wa=z(function(e,t){var r=Pt(t,ar(Wa));return ft(e,It,i,t,r)}),id=dt(function(e,t){return ft(e,Te,i,i,i,t)});function nd(e,t){if(typeof e!="function")throw new ze(y);return t=t===i?t:L(t),z(e,t)}function sd(e,t){if(typeof e!="function")throw new ze(y);return t=t==null?0:ge(L(t),0),z(function(r){var s=r[t],a=qt(r,0,t);return s&&bt(a,s),$e(e,this,a)})}function od(e,t,r){var s=!0,a=!0;if(typeof e!="function")throw new ze(y);return ae(r)&&(s="leading"in r?!!r.leading:s,a="trailing"in r?!!r.trailing:a),Ga(e,t,{leading:s,maxWait:t,trailing:a})}function ad(e){return ka(e,1)}function cd(e,t){return is(kn(t),e)}function ud(){if(!arguments.length)return[];var e=arguments[0];return $(e)?e:[e]}function hd(e){return Ge(e,J)}function ld(e,t){return t=typeof t=="function"?t:i,Ge(e,J,t)}function pd(e){return Ge(e,M|J)}function fd(e,t){return t=typeof t=="function"?t:i,Ge(e,M|J,t)}function dd(e,t){return t==null||To(e,t,ve(t))}function tt(e,t){return e===t||e!==e&&t!==t}var gd=Ci(qn),vd=Ci(function(e,t){return e>=t}),Vt=Uo(function(){return arguments}())?Uo:function(e){return ce(e)&&Z.call(e,"callee")&&!Ro.call(e,"callee")},$=v.isArray,md=oo?je(oo):Pl;function Oe(e){return e!=null&&ji(e.length)&&!vt(e)}function he(e){return ce(e)&&Oe(e)}function yd(e){return e===!0||e===!1||ce(e)&&Pe(e)==gr}var Ot=Nh||ds,_d=ao?je(ao):Sl;function wd(e){return ce(e)&&e.nodeType===1&&!jr(e)}function Id(e){if(e==null)return!0;if(Oe(e)&&($(e)||typeof e=="string"||typeof e.splice=="function"||Ot(e)||cr(e)||Vt(e)))return!e.length;var t=be(e);if(t==Ye||t==Ze)return!e.size;if(Tr(e))return!xn(e).length;for(var r in e)if(Z.call(e,r))return!1;return!0}function Ed(e,t){return Nr(e,t)}function bd(e,t,r){r=typeof r=="function"?r:i;var s=r?r(e,t):i;return s===i?Nr(e,t,i,r):!!s}function ns(e){if(!ce(e))return!1;var t=Pe(e);return t==Kr||t==Bc||typeof e.message=="string"&&typeof e.name=="string"&&!jr(e)}function Pd(e){return typeof e=="number"&&Ao(e)}function vt(e){if(!ae(e))return!1;var t=Pe(e);return t==Qr||t==Ts||t==zc||t==Wc}function Ka(e){return typeof e=="number"&&e==L(e)}function ji(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ee}function ae(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ce(e){return e!=null&&typeof e=="object"}var Qa=co?je(co):Cl;function Sd(e,t){return e===t||Nn(e,t,Kn(t))}function Rd(e,t,r){return r=typeof r=="function"?r:i,Nn(e,t,Kn(t),r)}function Cd(e){return Ja(e)&&e!=+e}function Ad(e){if(hp(e))throw new T(f);return ko(e)}function qd(e){return e===null}function Od(e){return e==null}function Ja(e){return typeof e=="number"||ce(e)&&Pe(e)==mr}function jr(e){if(!ce(e)||Pe(e)!=ut)return!1;var t=ui(e);if(t===null)return!0;var r=Z.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&si.call(r)==Sh}var ss=uo?je(uo):Al;function Nd(e){return Ka(e)&&e>=-ee&&e<=ee}var Ya=ho?je(ho):ql;function Mi(e){return typeof e=="string"||!$(e)&&ce(e)&&Pe(e)==_r}function Le(e){return typeof e=="symbol"||ce(e)&&Pe(e)==Jr}var cr=lo?je(lo):Ol;function xd(e){return e===i}function Dd(e){return ce(e)&&be(e)==wr}function Td(e){return ce(e)&&Pe(e)==Qc}var $d=Ci(Dn),jd=Ci(function(e,t){return e<=t});function Za(e){if(!e)return[];if(Oe(e))return Mi(e)?Xe(e):qe(e);if(br&&e[br])return fh(e[br]());var t=be(e),r=t==Ye?wn:t==Ze?ri:ur;return r(e)}function mt(e){if(!e)return e===0?e:0;if(e=Qe(e),e===ne||e===-ne){var t=e<0?-1:1;return t*Y}return e===e?e:0}function L(e){var t=mt(e),r=t%1;return t===t?r?t-r:t:0}function Xa(e){return e?Lt(L(e),0,Ie):0}function Qe(e){if(typeof e=="number")return e;if(Le(e))return ct;if(ae(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ae(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=yo(e);var r=vu.test(e);return r||yu.test(e)?Ju(e.slice(2),r?2:8):gu.test(e)?ct:+e}function ec(e){return st(e,Ne(e))}function Md(e){return e?Lt(L(e),-ee,ee):e===0?e:0}function Q(e){return e==null?"":Me(e)}var Ld=sr(function(e,t){if(Tr(t)||Oe(t)){st(t,ve(t),e);return}for(var r in t)Z.call(t,r)&&Ar(e,r,t[r])}),tc=sr(function(e,t){st(t,Ne(t),e)}),Li=sr(function(e,t,r,s){st(t,Ne(t),e,s)}),Hd=sr(function(e,t,r,s){st(t,ve(t),e,s)}),Ud=dt(Rn);function kd(e,t){var r=nr(e);return t==null?r:Do(r,t)}var Vd=z(function(e,t){e=X(e);var r=-1,s=t.length,a=s>2?t[2]:i;for(a&&Se(t[0],t[1],a)&&(s=1);++r<s;)for(var h=t[r],l=Ne(h),p=-1,g=l.length;++p<g;){var w=l[p],I=e[w];(I===i||tt(I,tr[w])&&!Z.call(e,w))&&(e[w]=h[w])}return e}),Fd=z(function(e){return e.push(i,ya),$e(rc,i,e)});function zd(e,t){return fo(e,N(t,3),nt)}function Bd(e,t){return fo(e,N(t,3),An)}function Gd(e,t){return e==null?e:Cn(e,N(t,3),Ne)}function Wd(e,t){return e==null?e:Lo(e,N(t,3),Ne)}function Kd(e,t){return e&&nt(e,N(t,3))}function Qd(e,t){return e&&An(e,N(t,3))}function Jd(e){return e==null?[]:_i(e,ve(e))}function Yd(e){return e==null?[]:_i(e,Ne(e))}function os(e,t,r){var s=e==null?i:Ht(e,t);return s===i?r:s}function Zd(e,t){return e!=null&&Ia(e,t,wl)}function as(e,t){return e!=null&&Ia(e,t,Il)}var Xd=fa(function(e,t,r){t!=null&&typeof t.toString!="function"&&(t=oi.call(t)),e[t]=r},us(xe)),eg=fa(function(e,t,r){t!=null&&typeof t.toString!="function"&&(t=oi.call(t)),Z.call(e,t)?e[t].push(r):e[t]=[r]},N),tg=z(Or);function ve(e){return Oe(e)?No(e):xn(e)}function Ne(e){return Oe(e)?No(e,!0):Nl(e)}function rg(e,t){var r={};return t=N(t,3),nt(e,function(s,a,h){pt(r,t(s,a,h),s)}),r}function ig(e,t){var r={};return t=N(t,3),nt(e,function(s,a,h){pt(r,a,t(s,a,h))}),r}var ng=sr(function(e,t,r){wi(e,t,r)}),rc=sr(function(e,t,r,s){wi(e,t,r,s)}),sg=dt(function(e,t){var r={};if(e==null)return r;var s=!1;t=se(t,function(h){return h=At(h,e),s||(s=h.length>1),h}),st(e,Gn(e),r),s&&(r=Ge(r,M|H|J,Zl));for(var a=t.length;a--;)Ln(r,t[a]);return r});function og(e,t){return ic(e,$i(N(t)))}var ag=dt(function(e,t){return e==null?{}:Dl(e,t)});function ic(e,t){if(e==null)return{};var r=se(Gn(e),function(s){return[s]});return t=N(t),Ko(e,r,function(s,a){return t(s,a[0])})}function cg(e,t,r){t=At(t,e);var s=-1,a=t.length;for(a||(a=1,e=i);++s<a;){var h=e==null?i:e[ot(t[s])];h===i&&(s=a,h=r),e=vt(h)?h.call(e):h}return e}function ug(e,t,r){return e==null?e:xr(e,t,r)}function hg(e,t,r,s){return s=typeof s=="function"?s:i,e==null?e:xr(e,t,r,s)}var nc=va(ve),sc=va(Ne);function lg(e,t,r){var s=$(e),a=s||Ot(e)||cr(e);if(t=N(t,4),r==null){var h=e&&e.constructor;a?r=s?new h:[]:ae(e)?r=vt(h)?nr(ui(e)):{}:r={}}return(a?Fe:nt)(e,function(l,p,g){return t(r,l,p,g)}),r}function pg(e,t){return e==null?!0:Ln(e,t)}function fg(e,t,r){return e==null?e:Xo(e,t,kn(r))}function dg(e,t,r,s){return s=typeof s=="function"?s:i,e==null?e:Xo(e,t,kn(r),s)}function ur(e){return e==null?[]:_n(e,ve(e))}function gg(e){return e==null?[]:_n(e,Ne(e))}function vg(e,t,r){return r===i&&(r=t,t=i),r!==i&&(r=Qe(r),r=r===r?r:0),t!==i&&(t=Qe(t),t=t===t?t:0),Lt(Qe(e),t,r)}function mg(e,t,r){return t=mt(t),r===i?(r=t,t=0):r=mt(r),e=Qe(e),El(e,t,r)}function yg(e,t,r){if(r&&typeof r!="boolean"&&Se(e,t,r)&&(t=r=i),r===i&&(typeof t=="boolean"?(r=t,t=i):typeof e=="boolean"&&(r=e,e=i)),e===i&&t===i?(e=0,t=1):(e=mt(e),t===i?(t=e,e=0):t=mt(t)),e>t){var s=e;e=t,t=s}if(r||e%1||t%1){var a=qo();return Ee(e+a*(t-e+Qu("1e-"+((a+"").length-1))),t)}return $n(e,t)}var _g=or(function(e,t,r){return t=t.toLowerCase(),e+(r?oc(t):t)});function oc(e){return cs(Q(e).toLowerCase())}function ac(e){return e=Q(e),e&&e.replace(wu,ch).replace(Hu,"")}function wg(e,t,r){e=Q(e),t=Me(t);var s=e.length;r=r===i?s:Lt(L(r),0,s);var a=r;return r-=t.length,r>=0&&e.slice(r,a)==t}function Ig(e){return e=Q(e),e&&eu.test(e)?e.replace(Ms,uh):e}function Eg(e){return e=Q(e),e&&ou.test(e)?e.replace(rn,"\\$&"):e}var bg=or(function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}),Pg=or(function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}),Sg=ha("toLowerCase");function Rg(e,t,r){e=Q(e),t=L(t);var s=t?Xt(e):0;if(!t||s>=t)return e;var a=(t-s)/2;return Ri(fi(a),r)+e+Ri(pi(a),r)}function Cg(e,t,r){e=Q(e),t=L(t);var s=t?Xt(e):0;return t&&s<t?e+Ri(t-s,r):e}function Ag(e,t,r){e=Q(e),t=L(t);var s=t?Xt(e):0;return t&&s<t?Ri(t-s,r)+e:e}function qg(e,t,r){return r||t==null?t=0:t&&(t=+t),$h(Q(e).replace(nn,""),t||0)}function Og(e,t,r){return(r?Se(e,t,r):t===i)?t=1:t=L(t),jn(Q(e),t)}function Ng(){var e=arguments,t=Q(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var xg=or(function(e,t,r){return e+(r?"_":"")+t.toLowerCase()});function Dg(e,t,r){return r&&typeof r!="number"&&Se(e,t,r)&&(t=r=i),r=r===i?Ie:r>>>0,r?(e=Q(e),e&&(typeof t=="string"||t!=null&&!ss(t))&&(t=Me(t),!t&&Zt(e))?qt(Xe(e),0,r):e.split(t,r)):[]}var Tg=or(function(e,t,r){return e+(r?" ":"")+cs(t)});function $g(e,t,r){return e=Q(e),r=r==null?0:Lt(L(r),0,e.length),t=Me(t),e.slice(r,r+t.length)==t}function jg(e,t,r){var s=u.templateSettings;r&&Se(e,t,r)&&(t=i),e=Q(e),t=Li({},t,s,ma);var a=Li({},t.imports,s.imports,ma),h=ve(a),l=_n(a,h),p,g,w=0,I=t.interpolate||Yr,b="__p += '",C=In((t.escape||Yr).source+"|"+I.source+"|"+(I===Ls?du:Yr).source+"|"+(t.evaluate||Yr).source+"|$","g"),O="//# sourceURL="+(Z.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++zu+"]")+`
`;e.replace(C,function(D,B,W,He,Re,Ue){return W||(W=He),b+=e.slice(w,Ue).replace(Iu,hh),B&&(p=!0,b+=`' +
__e(`+B+`) +
'`),Re&&(g=!0,b+=`';
`+Re+`;
__p += '`),W&&(b+=`' +
((__t = (`+W+`)) == null ? '' : __t) +
'`),w=Ue+D.length,D}),b+=`';
`;var x=Z.call(t,"variable")&&t.variable;if(!x)b=`with (obj) {
`+b+`
}
`;else if(pu.test(x))throw new T(E);b=(g?b.replace(Jc,""):b).replace(Yc,"$1").replace(Zc,"$1;"),b="function("+(x||"obj")+`) {
`+(x?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(p?", __e = _.escape":"")+(g?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+b+`return __p
}`;var k=uc(function(){return K(h,O+"return "+b).apply(i,l)});if(k.source=b,ns(k))throw k;return k}function Mg(e){return Q(e).toLowerCase()}function Lg(e){return Q(e).toUpperCase()}function Hg(e,t,r){if(e=Q(e),e&&(r||t===i))return yo(e);if(!e||!(t=Me(t)))return e;var s=Xe(e),a=Xe(t),h=_o(s,a),l=wo(s,a)+1;return qt(s,h,l).join("")}function Ug(e,t,r){if(e=Q(e),e&&(r||t===i))return e.slice(0,Eo(e)+1);if(!e||!(t=Me(t)))return e;var s=Xe(e),a=wo(s,Xe(t))+1;return qt(s,0,a).join("")}function kg(e,t,r){if(e=Q(e),e&&(r||t===i))return e.replace(nn,"");if(!e||!(t=Me(t)))return e;var s=Xe(e),a=_o(s,Xe(t));return qt(s,a).join("")}function Vg(e,t){var r=Bi,s=ke;if(ae(t)){var a="separator"in t?t.separator:a;r="length"in t?L(t.length):r,s="omission"in t?Me(t.omission):s}e=Q(e);var h=e.length;if(Zt(e)){var l=Xe(e);h=l.length}if(r>=h)return e;var p=r-Xt(s);if(p<1)return s;var g=l?qt(l,0,p).join(""):e.slice(0,p);if(a===i)return g+s;if(l&&(p+=g.length-p),ss(a)){if(e.slice(p).search(a)){var w,I=g;for(a.global||(a=In(a.source,Q(Hs.exec(a))+"g")),a.lastIndex=0;w=a.exec(I);)var b=w.index;g=g.slice(0,b===i?p:b)}}else if(e.indexOf(Me(a),p)!=p){var C=g.lastIndexOf(a);C>-1&&(g=g.slice(0,C))}return g+s}function Fg(e){return e=Q(e),e&&Xc.test(e)?e.replace(js,mh):e}var zg=or(function(e,t,r){return e+(r?" ":"")+t.toUpperCase()}),cs=ha("toUpperCase");function cc(e,t,r){return e=Q(e),t=r?i:t,t===i?ph(e)?wh(e):ih(e):e.match(t)||[]}var uc=z(function(e,t){try{return $e(e,i,t)}catch(r){return ns(r)?r:new T(r)}}),Bg=dt(function(e,t){return Fe(t,function(r){r=ot(r),pt(e,r,rs(e[r],e))}),e});function Gg(e){var t=e==null?0:e.length,r=N();return e=t?se(e,function(s){if(typeof s[1]!="function")throw new ze(y);return[r(s[0]),s[1]]}):[],z(function(s){for(var a=-1;++a<t;){var h=e[a];if($e(h[0],this,s))return $e(h[1],this,s)}})}function Wg(e){return ml(Ge(e,M))}function us(e){return function(){return e}}function Kg(e,t){return e==null||e!==e?t:e}var Qg=pa(),Jg=pa(!0);function xe(e){return e}function hs(e){return Vo(typeof e=="function"?e:Ge(e,M))}function Yg(e){return zo(Ge(e,M))}function Zg(e,t){return Bo(e,Ge(t,M))}var Xg=z(function(e,t){return function(r){return Or(r,e,t)}}),ev=z(function(e,t){return function(r){return Or(e,r,t)}});function ls(e,t,r){var s=ve(t),a=_i(t,s);r==null&&!(ae(t)&&(a.length||!s.length))&&(r=t,t=e,e=this,a=_i(t,ve(t)));var h=!(ae(r)&&"chain"in r)||!!r.chain,l=vt(e);return Fe(a,function(p){var g=t[p];e[p]=g,l&&(e.prototype[p]=function(){var w=this.__chain__;if(h||w){var I=e(this.__wrapped__),b=I.__actions__=qe(this.__actions__);return b.push({func:g,args:arguments,thisArg:e}),I.__chain__=w,I}return g.apply(e,bt([this.value()],arguments))})}),e}function tv(){return me._===this&&(me._=Rh),this}function ps(){}function rv(e){return e=L(e),z(function(t){return Go(t,e)})}var iv=Fn(se),nv=Fn(po),sv=Fn(dn);function hc(e){return Jn(e)?gn(ot(e)):Tl(e)}function ov(e){return function(t){return e==null?i:Ht(e,t)}}var av=da(),cv=da(!0);function fs(){return[]}function ds(){return!1}function uv(){return{}}function hv(){return""}function lv(){return!0}function pv(e,t){if(e=L(e),e<1||e>ee)return[];var r=Ie,s=Ee(e,Ie);t=N(t),e-=Ie;for(var a=yn(s,t);++r<e;)t(r);return a}function fv(e){return $(e)?se(e,ot):Le(e)?[e]:qe(Oa(Q(e)))}function dv(e){var t=++Ph;return Q(e)+t}var gv=Si(function(e,t){return e+t},0),vv=zn("ceil"),mv=Si(function(e,t){return e/t},1),yv=zn("floor");function _v(e){return e&&e.length?yi(e,xe,qn):i}function wv(e,t){return e&&e.length?yi(e,N(t,2),qn):i}function Iv(e){return vo(e,xe)}function Ev(e,t){return vo(e,N(t,2))}function bv(e){return e&&e.length?yi(e,xe,Dn):i}function Pv(e,t){return e&&e.length?yi(e,N(t,2),Dn):i}var Sv=Si(function(e,t){return e*t},1),Rv=zn("round"),Cv=Si(function(e,t){return e-t},0);function Av(e){return e&&e.length?mn(e,xe):0}function qv(e,t){return e&&e.length?mn(e,N(t,2)):0}return u.after=Yf,u.ary=ka,u.assign=Ld,u.assignIn=tc,u.assignInWith=Li,u.assignWith=Hd,u.at=Ud,u.before=Va,u.bind=rs,u.bindAll=Bg,u.bindKey=Fa,u.castArray=ud,u.chain=La,u.chunk=mp,u.compact=yp,u.concat=_p,u.cond=Gg,u.conforms=Wg,u.constant=us,u.countBy=Af,u.create=kd,u.curry=za,u.curryRight=Ba,u.debounce=Ga,u.defaults=Vd,u.defaultsDeep=Fd,u.defer=Zf,u.delay=Xf,u.difference=wp,u.differenceBy=Ip,u.differenceWith=Ep,u.drop=bp,u.dropRight=Pp,u.dropRightWhile=Sp,u.dropWhile=Rp,u.fill=Cp,u.filter=Of,u.flatMap=Df,u.flatMapDeep=Tf,u.flatMapDepth=$f,u.flatten=Ta,u.flattenDeep=Ap,u.flattenDepth=qp,u.flip=ed,u.flow=Qg,u.flowRight=Jg,u.fromPairs=Op,u.functions=Jd,u.functionsIn=Yd,u.groupBy=jf,u.initial=xp,u.intersection=Dp,u.intersectionBy=Tp,u.intersectionWith=$p,u.invert=Xd,u.invertBy=eg,u.invokeMap=Lf,u.iteratee=hs,u.keyBy=Hf,u.keys=ve,u.keysIn=Ne,u.map=xi,u.mapKeys=rg,u.mapValues=ig,u.matches=Yg,u.matchesProperty=Zg,u.memoize=Ti,u.merge=ng,u.mergeWith=rc,u.method=Xg,u.methodOf=ev,u.mixin=ls,u.negate=$i,u.nthArg=rv,u.omit=sg,u.omitBy=og,u.once=td,u.orderBy=Uf,u.over=iv,u.overArgs=rd,u.overEvery=nv,u.overSome=sv,u.partial=is,u.partialRight=Wa,u.partition=kf,u.pick=ag,u.pickBy=ic,u.property=hc,u.propertyOf=ov,u.pull=Hp,u.pullAll=ja,u.pullAllBy=Up,u.pullAllWith=kp,u.pullAt=Vp,u.range=av,u.rangeRight=cv,u.rearg=id,u.reject=zf,u.remove=Fp,u.rest=nd,u.reverse=es,u.sampleSize=Gf,u.set=ug,u.setWith=hg,u.shuffle=Wf,u.slice=zp,u.sortBy=Jf,u.sortedUniq=Yp,u.sortedUniqBy=Zp,u.split=Dg,u.spread=sd,u.tail=Xp,u.take=ef,u.takeRight=tf,u.takeRightWhile=rf,u.takeWhile=nf,u.tap=_f,u.throttle=od,u.thru=Ni,u.toArray=Za,u.toPairs=nc,u.toPairsIn=sc,u.toPath=fv,u.toPlainObject=ec,u.transform=lg,u.unary=ad,u.union=sf,u.unionBy=of,u.unionWith=af,u.uniq=cf,u.uniqBy=uf,u.uniqWith=hf,u.unset=pg,u.unzip=ts,u.unzipWith=Ma,u.update=fg,u.updateWith=dg,u.values=ur,u.valuesIn=gg,u.without=lf,u.words=cc,u.wrap=cd,u.xor=pf,u.xorBy=ff,u.xorWith=df,u.zip=gf,u.zipObject=vf,u.zipObjectDeep=mf,u.zipWith=yf,u.entries=nc,u.entriesIn=sc,u.extend=tc,u.extendWith=Li,ls(u,u),u.add=gv,u.attempt=uc,u.camelCase=_g,u.capitalize=oc,u.ceil=vv,u.clamp=vg,u.clone=hd,u.cloneDeep=pd,u.cloneDeepWith=fd,u.cloneWith=ld,u.conformsTo=dd,u.deburr=ac,u.defaultTo=Kg,u.divide=mv,u.endsWith=wg,u.eq=tt,u.escape=Ig,u.escapeRegExp=Eg,u.every=qf,u.find=Nf,u.findIndex=xa,u.findKey=zd,u.findLast=xf,u.findLastIndex=Da,u.findLastKey=Bd,u.floor=yv,u.forEach=Ha,u.forEachRight=Ua,u.forIn=Gd,u.forInRight=Wd,u.forOwn=Kd,u.forOwnRight=Qd,u.get=os,u.gt=gd,u.gte=vd,u.has=Zd,u.hasIn=as,u.head=$a,u.identity=xe,u.includes=Mf,u.indexOf=Np,u.inRange=mg,u.invoke=tg,u.isArguments=Vt,u.isArray=$,u.isArrayBuffer=md,u.isArrayLike=Oe,u.isArrayLikeObject=he,u.isBoolean=yd,u.isBuffer=Ot,u.isDate=_d,u.isElement=wd,u.isEmpty=Id,u.isEqual=Ed,u.isEqualWith=bd,u.isError=ns,u.isFinite=Pd,u.isFunction=vt,u.isInteger=Ka,u.isLength=ji,u.isMap=Qa,u.isMatch=Sd,u.isMatchWith=Rd,u.isNaN=Cd,u.isNative=Ad,u.isNil=Od,u.isNull=qd,u.isNumber=Ja,u.isObject=ae,u.isObjectLike=ce,u.isPlainObject=jr,u.isRegExp=ss,u.isSafeInteger=Nd,u.isSet=Ya,u.isString=Mi,u.isSymbol=Le,u.isTypedArray=cr,u.isUndefined=xd,u.isWeakMap=Dd,u.isWeakSet=Td,u.join=jp,u.kebabCase=bg,u.last=Ke,u.lastIndexOf=Mp,u.lowerCase=Pg,u.lowerFirst=Sg,u.lt=$d,u.lte=jd,u.max=_v,u.maxBy=wv,u.mean=Iv,u.meanBy=Ev,u.min=bv,u.minBy=Pv,u.stubArray=fs,u.stubFalse=ds,u.stubObject=uv,u.stubString=hv,u.stubTrue=lv,u.multiply=Sv,u.nth=Lp,u.noConflict=tv,u.noop=ps,u.now=Di,u.pad=Rg,u.padEnd=Cg,u.padStart=Ag,u.parseInt=qg,u.random=yg,u.reduce=Vf,u.reduceRight=Ff,u.repeat=Og,u.replace=Ng,u.result=cg,u.round=Rv,u.runInContext=d,u.sample=Bf,u.size=Kf,u.snakeCase=xg,u.some=Qf,u.sortedIndex=Bp,u.sortedIndexBy=Gp,u.sortedIndexOf=Wp,u.sortedLastIndex=Kp,u.sortedLastIndexBy=Qp,u.sortedLastIndexOf=Jp,u.startCase=Tg,u.startsWith=$g,u.subtract=Cv,u.sum=Av,u.sumBy=qv,u.template=jg,u.times=pv,u.toFinite=mt,u.toInteger=L,u.toLength=Xa,u.toLower=Mg,u.toNumber=Qe,u.toSafeInteger=Md,u.toString=Q,u.toUpper=Lg,u.trim=Hg,u.trimEnd=Ug,u.trimStart=kg,u.truncate=Vg,u.unescape=Fg,u.uniqueId=dv,u.upperCase=zg,u.upperFirst=cs,u.each=Ha,u.eachRight=Ua,u.first=$a,ls(u,function(){var e={};return nt(u,function(t,r){Z.call(u.prototype,r)||(e[r]=t)}),e}(),{chain:!1}),u.VERSION=o,Fe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){u[e].placeholder=u}),Fe(["drop","take"],function(e,t){G.prototype[e]=function(r){r=r===i?1:ge(L(r),0);var s=this.__filtered__&&!t?new G(this):this.clone();return s.__filtered__?s.__takeCount__=Ee(r,s.__takeCount__):s.__views__.push({size:Ee(r,Ie),type:e+(s.__dir__<0?"Right":"")}),s},G.prototype[e+"Right"]=function(r){return this.reverse()[e](r).reverse()}}),Fe(["filter","map","takeWhile"],function(e,t){var r=t+1,s=r==m||r==U;G.prototype[e]=function(a){var h=this.clone();return h.__iteratees__.push({iteratee:N(a,3),type:r}),h.__filtered__=h.__filtered__||s,h}}),Fe(["head","last"],function(e,t){var r="take"+(t?"Right":"");G.prototype[e]=function(){return this[r](1).value()[0]}}),Fe(["initial","tail"],function(e,t){var r="drop"+(t?"":"Right");G.prototype[e]=function(){return this.__filtered__?new G(this):this[r](1)}}),G.prototype.compact=function(){return this.filter(xe)},G.prototype.find=function(e){return this.filter(e).head()},G.prototype.findLast=function(e){return this.reverse().find(e)},G.prototype.invokeMap=z(function(e,t){return typeof e=="function"?new G(this):this.map(function(r){return Or(r,e,t)})}),G.prototype.reject=function(e){return this.filter($i(N(e)))},G.prototype.slice=function(e,t){e=L(e);var r=this;return r.__filtered__&&(e>0||t<0)?new G(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==i&&(t=L(t),r=t<0?r.dropRight(-t):r.take(t-e)),r)},G.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},G.prototype.toArray=function(){return this.take(Ie)},nt(G.prototype,function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),s=/^(?:head|last)$/.test(t),a=u[s?"take"+(t=="last"?"Right":""):t],h=s||/^find/.test(t);a&&(u.prototype[t]=function(){var l=this.__wrapped__,p=s?[1]:arguments,g=l instanceof G,w=p[0],I=g||$(l),b=function(B){var W=a.apply(u,bt([B],p));return s&&C?W[0]:W};I&&r&&typeof w=="function"&&w.length!=1&&(g=I=!1);var C=this.__chain__,O=!!this.__actions__.length,x=h&&!C,k=g&&!O;if(!h&&I){l=k?l:new G(this);var D=e.apply(l,p);return D.__actions__.push({func:Ni,args:[b],thisArg:i}),new Be(D,C)}return x&&k?e.apply(this,p):(D=this.thru(b),x?s?D.value()[0]:D.value():D)})}),Fe(["pop","push","shift","sort","splice","unshift"],function(e){var t=ii[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",s=/^(?:pop|shift)$/.test(e);u.prototype[e]=function(){var a=arguments;if(s&&!this.__chain__){var h=this.value();return t.apply($(h)?h:[],a)}return this[r](function(l){return t.apply($(l)?l:[],a)})}}),nt(G.prototype,function(e,t){var r=u[t];if(r){var s=r.name+"";Z.call(ir,s)||(ir[s]=[]),ir[s].push({name:t,func:r})}}),ir[Pi(i,Ae).name]=[{name:"wrapper",func:i}],G.prototype.clone=Vh,G.prototype.reverse=Fh,G.prototype.value=zh,u.prototype.at=wf,u.prototype.chain=If,u.prototype.commit=Ef,u.prototype.next=bf,u.prototype.plant=Sf,u.prototype.reverse=Rf,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=Cf,u.prototype.first=u.prototype.head,br&&(u.prototype[br]=Pf),u},er=Ih();Tt?((Tt.exports=er)._=er,hn._=er):me._=er}).call(Vr)})(Rs,Rs.exports);var xm=Object.defineProperty,Dm=Object.defineProperties,Tm=Object.getOwnPropertyDescriptors,Rc=Object.getOwnPropertySymbols,$m=Object.prototype.hasOwnProperty,jm=Object.prototype.propertyIsEnumerable,Cc=(P,n,i)=>n in P?xm(P,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):P[n]=i,ki=(P,n)=>{for(var i in n||(n={}))$m.call(n,i)&&Cc(P,i,n[i]);if(Rc)for(var i of Rc(n))jm.call(n,i)&&Cc(P,i,n[i]);return P},Mm=(P,n)=>Dm(P,Tm(n));function Nt(P,n,i){var o;const c=hm(P);return((o=n.rpcMap)==null?void 0:o[c.reference])||`${Nm}?chainId=${c.namespace}:${c.reference}&projectId=${i}`}function Gt(P){return P.includes(":")?P.split(":")[1]:P}function Uc(P){return P.map(n=>`${n.split(":")[0]}:${n.split(":")[1]}`)}function Lm(P,n){const i=Object.keys(n.namespaces).filter(c=>c.includes(P));if(!i.length)return[];const o=[];return i.forEach(c=>{const f=n.namespaces[c].accounts;o.push(...f)}),o}function Hm(P={},n={}){const i=Ac(P),o=Ac(n);return Rs.exports.merge(i,o)}function Ac(P){var n,i,o,c;const f={};if(!Fi(P))return f;for(const[y,E]of Object.entries(P)){const S=$c(y)?[y]:E.chains,q=E.methods||[],j=E.events||[],M=E.rpcMap||{},H=Fr(y);f[H]=Mm(ki(ki({},f[H]),E),{chains:ys(S,(n=f[H])==null?void 0:n.chains),methods:ys(q,(i=f[H])==null?void 0:i.methods),events:ys(j,(o=f[H])==null?void 0:o.events),rpcMap:ki(ki({},M),(c=f[H])==null?void 0:c.rpcMap)})}return f}function Um(P){return P.includes(":")?P.split(":")[2]:P}function km(P){const n={};for(const[i,o]of Object.entries(P)){const c=o.methods||[],f=o.events||[],y=o.accounts||[],E=$c(i)?[i]:o.chains?o.chains:Uc(o.accounts);n[i]={chains:E,methods:c,events:f,accounts:y}}return n}function Is(P){return typeof P=="number"?P:P.includes("0x")?parseInt(P,16):P.includes(":")?Number(P.split(":")[1]):Number(P)}const kc={},oe=P=>kc[P],Es=(P,n)=>{kc[P]=n};class Vm{constructor(n){this.name="polkadot",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}getAccounts(){const n=this.namespace.accounts;return n?n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Fm{constructor(n){this.name="eip155",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(n){switch(n.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(n);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(n.request.method)?await this.client.request(n):this.getHttpProvider().request(n.request)}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(parseInt(n),i),this.chainId=parseInt(n),this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}createHttpProvider(n,i){const o=i||Nt(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=parseInt(Gt(i));n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const n=this.chainId,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}async handleSwitchChain(n){var i,o;let c=n.request.params?(i=n.request.params[0])==null?void 0:i.chainId:"0x0";c=c.startsWith("0x")?c:`0x${c}`;const f=parseInt(c,16);if(this.isChainApproved(f))this.setDefaultChain(`${f}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:n.topic,request:{method:n.request.method,params:[{chainId:c}]},chainId:(o=this.namespace.chains)==null?void 0:o[0]}),this.setDefaultChain(`${f}`);else throw new Error(`Failed to switch to chain 'eip155:${f}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(n){return this.namespace.chains.includes(`${this.name}:${n}`)}}class zm{constructor(n){this.name="solana",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Bm{constructor(n){this.name="cosmos",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Gm{constructor(n){this.name="cip34",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{const o=this.getCardanoRPCUrl(i),c=Gt(i);n[c]=this.createHttpProvider(c,o)}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}getCardanoRPCUrl(n){const i=this.namespace.rpcMap;if(i)return i[n]}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||this.getCardanoRPCUrl(n);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Wm{constructor(n){this.name="elrond",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Km{constructor(n){this.name="multiversx",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Qm{constructor(n){this.name="near",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){if(this.chainId=n,!this.httpProviders[n]){const o=i||Nt(`${this.name}:${n}`,this.namespace);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,o)}this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const n=this.namespace.accounts;return n?n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;n[i]=this.createHttpProvider(i,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace);return typeof o>"u"?void 0:new xt(new Dt(o,oe("disableProviderPing")))}}var Jm=Object.defineProperty,Ym=Object.defineProperties,Zm=Object.getOwnPropertyDescriptors,qc=Object.getOwnPropertySymbols,Xm=Object.prototype.hasOwnProperty,e0=Object.prototype.propertyIsEnumerable,Oc=(P,n,i)=>n in P?Jm(P,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):P[n]=i,Vi=(P,n)=>{for(var i in n||(n={}))Xm.call(n,i)&&Oc(P,i,n[i]);if(qc)for(var i of qc(n))e0.call(n,i)&&Oc(P,i,n[i]);return P},bs=(P,n)=>Ym(P,Zm(n));class xs{constructor(n){this.events=new Gr.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=n,this.logger=typeof(n==null?void 0:n.logger)<"u"&&typeof(n==null?void 0:n.logger)!="string"?n.logger:lr.pino(lr.getDefaultLoggerOptions({level:(n==null?void 0:n.logger)||Pc})),this.disableProviderPing=(n==null?void 0:n.disableProviderPing)||!1}static async init(n){const i=new xs(n);return await i.initialize(),i}async request(n,i){const[o,c]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:Vi({},n),chainId:`${o}:${c}`,topic:this.session.topic})}sendAsync(n,i,o){this.request(n,o).then(c=>i(null,c)).catch(c=>i(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var n;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(n=this.session)==null?void 0:n.topic,reason:at("USER_DISCONNECTED")}),await this.cleanup()}async connect(n){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(n),await this.cleanupPendingPairings(),!n.skipPairing)return await this.pair(n.pairingTopic)}on(n,i){this.events.on(n,i)}once(n,i){this.events.once(n,i)}removeListener(n,i){this.events.removeListener(n,i)}off(n,i){this.events.off(n,i)}get isWalletConnect(){return!0}async pair(n){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:o,approval:c}=await this.client.connect({pairingTopic:n,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});o&&(this.uri=o,this.events.emit("display_uri",o)),await c().then(f=>{this.session=f,this.namespaces||(this.namespaces=km(f.namespaces),this.persist("namespaces",this.namespaces))}).catch(f=>{if(f.message!==Hc)throw f;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(n,i){try{if(!this.session)return;const[o,c]=this.validateChain(n);this.getProvider(o).setDefaultChain(c,i)}catch(o){if(!/Please call connect/.test(o.message))throw o}}async cleanupPendingPairings(n={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(Br(i)){for(const o of i)n.deletePairings?this.client.core.expirer.set(o.topic,0):await this.client.core.relayer.subscriber.unsubscribe(o.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const n=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[n]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Ns.init({logger:this.providerOpts.logger||Pc,relayUrl:this.providerOpts.relayUrl||Am,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const n=[...new Set(Object.keys(this.session.namespaces).map(i=>Fr(i)))];Es("client",this.client),Es("events",this.events),Es("disableProviderPing",this.disableProviderPing),n.forEach(i=>{if(!this.session)return;const o=Lm(i,this.session),c=Uc(o),f=Hm(this.namespaces,this.optionalNamespaces),y=bs(Vi({},f[i]),{accounts:o,chains:c});switch(i){case"eip155":this.rpcProviders[i]=new Fm({namespace:y});break;case"solana":this.rpcProviders[i]=new zm({namespace:y});break;case"cosmos":this.rpcProviders[i]=new Bm({namespace:y});break;case"polkadot":this.rpcProviders[i]=new Vm({namespace:y});break;case"cip34":this.rpcProviders[i]=new Gm({namespace:y});break;case"elrond":this.rpcProviders[i]=new Wm({namespace:y});break;case"multiversx":this.rpcProviders[i]=new Km({namespace:y});break;case"near":this.rpcProviders[i]=new Qm({namespace:y});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",n=>{this.events.emit("session_ping",n)}),this.client.on("session_event",n=>{const{params:i}=n,{event:o}=i;if(o.name==="accountsChanged"){const c=o.data;c&&Br(c)&&this.events.emit("accountsChanged",c.map(Um))}else if(o.name==="chainChanged"){const c=i.chainId,f=i.event.data,y=Fr(c),E=Is(c)!==Is(f)?`${y}:${Is(f)}`:c;this.onChainChanged(E)}else this.events.emit(o.name,o.data);this.events.emit("session_event",n)}),this.client.on("session_update",({topic:n,params:i})=>{var o;const{namespaces:c}=i,f=(o=this.client)==null?void 0:o.session.get(n);this.session=bs(Vi({},f),{namespaces:c}),this.onSessionUpdate(),this.events.emit("session_update",{topic:n,params:i})}),this.client.on("session_delete",async n=>{await this.cleanup(),this.events.emit("session_delete",n),this.events.emit("disconnect",bs(Vi({},at("USER_DISCONNECTED")),{data:n.topic}))}),this.on(wt.DEFAULT_CHAIN_CHANGED,n=>{this.onChainChanged(n,!0)})}getProvider(n){if(!this.rpcProviders[n])throw new Error(`Provider not found: ${n}`);return this.rpcProviders[n]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(n=>{var i;this.getProvider(n).updateNamespace((i=this.session)==null?void 0:i.namespaces[n])})}setNamespaces(n){const{namespaces:i,optionalNamespaces:o,sessionProperties:c}=n;i&&Object.keys(i).length&&(this.namespaces=i),o&&Object.keys(o).length&&(this.optionalNamespaces=o),this.sessionProperties=c,this.persist("namespaces",i),this.persist("optionalNamespaces",o)}validateChain(n){const[i,o]=(n==null?void 0:n.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,o];if(i&&!Object.keys(this.namespaces||{}).map(y=>Fr(y)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&o)return[i,o];const c=Fr(Object.keys(this.namespaces)[0]),f=this.rpcProviders[c].getDefaultChain();return[c,f]}async requestAccounts(){const[n]=this.validateChain();return await this.getProvider(n).requestAccounts()}onChainChanged(n,i=!1){var o;if(!this.namespaces)return;const[c,f]=this.validateChain(n);i||this.getProvider(c).setDefaultChain(f),((o=this.namespaces[c])!=null?o:this.namespaces[`${c}:${f}`]).defaultChain=f,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",f)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(n,i){this.client.core.storage.setItem(`${Sc}/${n}`,i)}async getFromStore(n){return await this.client.core.storage.getItem(`${Sc}/${n}`)}}const t0=xs,r0="wc",i0="ethereum_provider",n0=`${r0}@2:${i0}:`,s0="https://rpc.walletconnect.com/v1/",Cs=["eth_sendTransaction","personal_sign"],o0=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],As=["chainChanged","accountsChanged"],a0=["chainChanged","accountsChanged","message","disconnect","connect"];var c0=Object.defineProperty,u0=Object.defineProperties,h0=Object.getOwnPropertyDescriptors,Nc=Object.getOwnPropertySymbols,l0=Object.prototype.hasOwnProperty,p0=Object.prototype.propertyIsEnumerable,xc=(P,n,i)=>n in P?c0(P,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):P[n]=i,zr=(P,n)=>{for(var i in n||(n={}))l0.call(n,i)&&xc(P,i,n[i]);if(Nc)for(var i of Nc(n))p0.call(n,i)&&xc(P,i,n[i]);return P},Dc=(P,n)=>u0(P,h0(n));function zi(P){return Number(P[0].split(":")[1])}function Ps(P){return`0x${P.toString(16)}`}function f0(P){const{chains:n,optionalChains:i,methods:o,optionalMethods:c,events:f,optionalEvents:y,rpcMap:E}=P;if(!Br(n))throw new Error("Invalid chains");const S={chains:n,methods:o||Cs,events:f||As,rpcMap:zr({},n.length?{[zi(n)]:E[zi(n)]}:{})},q=f==null?void 0:f.filter(J=>!As.includes(J)),j=o==null?void 0:o.filter(J=>!Cs.includes(J));if(!i&&!y&&!c&&!(q!=null&&q.length)&&!(j!=null&&j.length))return{required:n.length?S:void 0};const M=(q==null?void 0:q.length)&&(j==null?void 0:j.length)||!i,H={chains:[...new Set(M?S.chains.concat(i||[]):i)],methods:[...new Set(S.methods.concat(c!=null&&c.length?c:o0))],events:[...new Set(S.events.concat(y!=null&&y.length?y:a0))],rpcMap:E};return{required:n.length?S:void 0,optional:i.length?H:void 0}}class Ds{constructor(){this.events=new Gr.exports.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=n0,this.on=(n,i)=>(this.events.on(n,i),this),this.once=(n,i)=>(this.events.once(n,i),this),this.removeListener=(n,i)=>(this.events.removeListener(n,i),this),this.off=(n,i)=>(this.events.off(n,i),this),this.parseAccount=n=>this.isCompatibleChainId(n)?this.parseAccountId(n).address:n,this.signer={},this.rpc={}}static async init(n){const i=new Ds;return await i.initialize(n),i}async request(n){return await this.signer.request(n,this.formatChainId(this.chainId))}sendAsync(n,i){this.signer.sendAsync(n,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(n){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(n);const{required:i,optional:o}=f0(this.rpc);try{const c=await new Promise(async(y,E)=>{var S;this.rpc.showQrModal&&((S=this.modal)==null||S.subscribeModal(q=>{!q.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),E(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Dc(zr({namespaces:zr({},i&&{[this.namespace]:i})},o&&{optionalNamespaces:{[this.namespace]:o}}),{pairingTopic:n==null?void 0:n.pairingTopic})).then(q=>{y(q)}).catch(q=>{E(new Error(q.message))})});if(!c)return;const f=lm(c.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:f),this.setAccounts(f),this.events.emit("connect",{chainId:Ps(this.chainId)})}catch(c){throw this.signer.logger.error(c),c}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",n=>{const{params:i}=n,{event:o}=i;o.name==="accountsChanged"?(this.accounts=this.parseAccounts(o.data),this.events.emit("accountsChanged",this.accounts)):o.name==="chainChanged"?this.setChainId(this.formatChainId(o.data)):this.events.emit(o.name,o.data),this.events.emit("session_event",n)}),this.signer.on("chainChanged",n=>{const i=parseInt(n);this.chainId=i,this.events.emit("chainChanged",Ps(this.chainId)),this.persist()}),this.signer.on("session_update",n=>{this.events.emit("session_update",n)}),this.signer.on("session_delete",n=>{this.reset(),this.events.emit("session_delete",n),this.events.emit("disconnect",Dc(zr({},at("USER_DISCONNECTED")),{data:n.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",n=>{var i,o;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(o=this.modal)==null||o.openModal({uri:n})),this.events.emit("display_uri",n)})}switchEthereumChain(n){this.request({method:"wallet_switchEthereumChain",params:[{chainId:n.toString(16)}]})}isCompatibleChainId(n){return typeof n=="string"?n.startsWith(`${this.namespace}:`):!1}formatChainId(n){return`${this.namespace}:${n}`}parseChainId(n){return Number(n.split(":")[1])}setChainIds(n){const i=n.filter(o=>this.isCompatibleChainId(o)).map(o=>this.parseChainId(o));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",Ps(this.chainId)),this.persist())}setChainId(n){if(this.isCompatibleChainId(n)){const i=this.parseChainId(n);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(n){const[i,o,c]=n.split(":");return{chainId:`${i}:${o}`,address:c}}setAccounts(n){this.accounts=n.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(n){var i,o;const c=(i=n==null?void 0:n.chains)!=null?i:[],f=(o=n==null?void 0:n.optionalChains)!=null?o:[],y=c.concat(f);if(!y.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const E=c.length?(n==null?void 0:n.methods)||Cs:[],S=c.length?(n==null?void 0:n.events)||As:[],q=(n==null?void 0:n.optionalMethods)||[],j=(n==null?void 0:n.optionalEvents)||[],M=(n==null?void 0:n.rpcMap)||this.buildRpcMap(y,n.projectId),H=(n==null?void 0:n.qrModalOptions)||void 0;return{chains:c==null?void 0:c.map(J=>this.formatChainId(J)),optionalChains:f.map(J=>this.formatChainId(J)),methods:E,events:S,optionalMethods:q,optionalEvents:j,rpcMap:M,showQrModal:!!(n!=null&&n.showQrModal),qrModalOptions:H,projectId:n.projectId,metadata:n.metadata}}buildRpcMap(n,i){const o={};return n.forEach(c=>{o[c]=this.getRpcUrl(c,i)}),o}async initialize(n){if(this.rpc=this.getRpcConfig(n),this.chainId=this.rpc.chains.length?zi(this.rpc.chains):zi(this.rpc.optionalChains),this.signer=await t0.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:n.disableProviderPing,relayUrl:n.relayUrl,storageOptions:n.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{i=require("@walletconnect/modal").WalletConnectModal}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(zr({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(o){throw this.signer.logger.error(o),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(n){if(!n)return;const{chains:i,optionalChains:o,rpcMap:c}=n;i&&Br(i)&&(this.rpc.chains=i.map(f=>this.formatChainId(f)),i.forEach(f=>{this.rpc.rpcMap[f]=(c==null?void 0:c[f])||this.getRpcUrl(f)})),o&&Br(o)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=o==null?void 0:o.map(f=>this.formatChainId(f)),o.forEach(f=>{this.rpc.rpcMap[f]=(c==null?void 0:c[f])||this.getRpcUrl(f)}))}getRpcUrl(n,i){var o;return((o=this.rpc.rpcMap)==null?void 0:o[n])||`${s0}?chainId=eip155:${n}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const n=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${n}`]?this.session.namespaces[`${this.namespace}:${n}`]:this.session.namespaces[this.namespace];this.setChainIds(n?[this.formatChainId(n)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(n){return typeof n=="string"||n instanceof String?[this.parseAccount(n)]:n.map(i=>this.parseAccount(i))}}const g0=Ds;export{g0 as EthereumProvider,a0 as OPTIONAL_EVENTS,o0 as OPTIONAL_METHODS,As as REQUIRED_EVENTS,Cs as REQUIRED_METHODS,Ds as default};
